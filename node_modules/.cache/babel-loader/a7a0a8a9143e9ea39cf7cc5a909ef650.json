{"ast":null,"code":"import _regeneratorRuntime from\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _styled4 from\"styled-components\";import _styled3 from\"styled-components\";import _styled2 from\"styled-components\";import _styled from\"styled-components\";import React,{useCallback,useState}from'react';import styled from'styled-components';import{Box,Button,GU,TextInput,textStyle,useLayout,useTheme}from'@1hive/1hive-ui';import{defaultEthNode,defaultIpfsGateway,defaultSubgraphHttpEndpoint}from'../../../endpoints';import{clearLocalStorageNetworkSettings,setDefaultEthNode,setIpfsGateway,setSubgraphHttpEndpoint}from'../../../local-settings';import{InvalidNetworkType,InvalidURI,NoConnection}from'../../../errors';import{checkValidEthNode,getNetworkType,sanitizeNetworkType}from'../../../lib/web3-utils';import{validHttpFormat}from'../../../lib/uri-utils';import{useEnterKey}from'../../../hooks/useKeyboardArrows';import{useSubgraph}from'../../../providers/Subgraph';var _StyledDiv=styled(\"div\").withConfig({displayName:\"Network___StyledDiv\",componentId:\"m2vdws-0\"})([\"margin-bottom:\",\"px;\"],function(p){return p._css;});var _StyledButton=styled(Button).withConfig({displayName:\"Network___StyledButton\",componentId:\"m2vdws-1\"})([\"margin-bottom:\",\"px;\"],function(p){return p._css2;});function Network(){var _useNetwork=useNetwork(),ethNode=_useNetwork.ethNode,handleClearNetworkSettings=_useNetwork.handleClearNetworkSettings,handleEthNodeChange=_useNetwork.handleEthNodeChange,handleIpfsGatewayChange=_useNetwork.handleIpfsGatewayChange,handleNetworkChange=_useNetwork.handleNetworkChange,handleSubgraphHttpEndpointChange=_useNetwork.handleSubgraphHttpEndpointChange,ipfsGateway=_useNetwork.ipfsGateway,settingsErrors=_useNetwork.settingsErrors,subgraphHttpEndpoint=_useNetwork.subgraphHttpEndpoint;var _useLayout=useLayout(),layoutName=_useLayout.layoutName;var compact=layoutName==='small';var _ref=settingsErrors||{},ethError=_ref.ethError,httpSubgraphError=_ref.httpSubgraphError;return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Box,{heading:\"Node settings\"},/*#__PURE__*/React.createElement(Field,{label:\"Ethereum node\",text:ethNode,onTextChange:handleEthNodeChange,error:ethError}),/*#__PURE__*/React.createElement(Field,{label:\"IPFS Gateway\",text:ipfsGateway,onTextChange:handleIpfsGatewayChange}),/*#__PURE__*/React.createElement(Field,{label:\"Subgraph HTTP endpoint\",text:subgraphHttpEndpoint,onTextChange:handleSubgraphHttpEndpointChange,error:httpSubgraphError}),/*#__PURE__*/React.createElement(Button,{mode:\"strong\",onClick:handleNetworkChange,wide:compact},\"Save changes\")),/*#__PURE__*/React.createElement(Box,{heading:\"Troubleshooting\"},/*#__PURE__*/React.createElement(_StyledDiv,{_css:2*GU},/*#__PURE__*/React.createElement(\"span\",null,\"Press this button to reset the network settings to their defaults.\")),/*#__PURE__*/React.createElement(_StyledButton,{onClick:handleClearNetworkSettings,wide:compact,_css2:2*GU},\"Reset network settings\")));}var _StyledTextInput=styled(TextInput).withConfig({displayName:\"Network___StyledTextInput\",componentId:\"m2vdws-2\"})([\"\",\";color:\",\";\"],function(p){return p._css3;},function(p){return p._css4;});var _StyledSpan=styled(\"span\").withConfig({displayName:\"Network___StyledSpan\",componentId:\"m2vdws-3\"})([\"\",\";color:\",\";\"],function(p){return p._css5;},function(p){return p._css6;});function Field(_ref2){var label=_ref2.label,text=_ref2.text,onTextChange=_ref2.onTextChange,error=_ref2.error;var theme=useTheme();return/*#__PURE__*/React.createElement(Label,{theme:theme},label,/*#__PURE__*/React.createElement(_StyledTextInput,{value:text,wide:true,onChange:onTextChange,_css3:textStyle('body2'),_css4:theme.contentSecondary}),error&&/*#__PURE__*/React.createElement(_StyledSpan,{_css5:textStyle('body4'),_css6:theme.negative},error));}var useNetwork=function useNetwork(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),settingsErrors=_useState2[0],setSettingsErrors=_useState2[1];var _useState3=useState(defaultEthNode),_useState4=_slicedToArray(_useState3,2),ethNode=_useState4[0],setEthNodeValue=_useState4[1];var _useState5=useState(defaultIpfsGateway),_useState6=_slicedToArray(_useState5,2),ipfsGateway=_useState6[0],setIpfsGatewayValue=_useState6[1];var _useState7=useState(defaultSubgraphHttpEndpoint),_useState8=_slicedToArray(_useState7,2),subgraphHttpEndpoint=_useState8[0],setSubgraphHttpEndpointValue=_useState8[1];var _useSubgraph=useSubgraph(),resetSubgraphClient=_useSubgraph.resetSubgraphClient;var networkType=getNetworkType();var subgraphChanged=subgraphHttpEndpoint!==defaultSubgraphHttpEndpoint;var defaultsChanged=ipfsGateway!==defaultIpfsGateway||ethNode!==defaultEthNode||subgraphChanged;var handleNetworkChange=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var errors;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(defaultsChanged){_context.next=3;break;}setSettingsErrors(null);return _context.abrupt(\"return\");case 3:_context.next=5;return validateNetworkSettings(ethNode,subgraphHttpEndpoint,networkType);case 5:errors=_context.sent;if(!errors){_context.next=9;break;}setSettingsErrors(errors);return _context.abrupt(\"return\");case 9:setDefaultEthNode(ethNode);setSubgraphHttpEndpoint(subgraphHttpEndpoint);setIpfsGateway(ipfsGateway);if(subgraphChanged){resetSubgraphClient();}window.location.reload();case 14:case\"end\":return _context.stop();}}},_callee);})),[defaultsChanged,ethNode,subgraphHttpEndpoint,networkType,ipfsGateway,subgraphChanged,resetSubgraphClient]);var handleClearNetworkSettings=useCallback(function(){clearLocalStorageNetworkSettings();window.location.reload();},[]);useEnterKey(handleNetworkChange);return{ethNode:ethNode,ipfsGateway:ipfsGateway,subgraphHttpEndpoint:subgraphHttpEndpoint,handleNetworkChange:handleNetworkChange,handleClearNetworkSettings:handleClearNetworkSettings,settingsErrors:settingsErrors,handleEthNodeChange:function handleEthNodeChange(_ref4){var value=_ref4.currentTarget.value;return setEthNodeValue(value);},handleIpfsGatewayChange:function handleIpfsGatewayChange(_ref5){var value=_ref5.currentTarget.value;return setIpfsGatewayValue(value);},handleSubgraphHttpEndpointChange:function handleSubgraphHttpEndpointChange(_ref6){var value=_ref6.currentTarget.value;return setSubgraphHttpEndpointValue(value);}};};function validateNetworkSettings(_x,_x2,_x3){return _validateNetworkSettings.apply(this,arguments);}function _validateNetworkSettings(){_validateNetworkSettings=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(ethNode,subgraphHttpEndpoint,networkType){var settingsErrors;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:settingsErrors={};_context2.prev=1;_context2.next=4;return checkValidEthNode(ethNode);case 4:_context2.next=15;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](1);if(_context2.t0 instanceof InvalidNetworkType){settingsErrors.ethError=\"Node must be connected to \".concat(sanitizeNetworkType(networkType));}if(_context2.t0 instanceof InvalidURI){settingsErrors.ethError='Must provide HTTP endpoint to node';}if(_context2.t0 instanceof NoConnection){settingsErrors.ethError='Could not connect to node';}if(!validHttpFormat(subgraphHttpEndpoint)){settingsErrors.httpSubgraphError='The URI must use the HTTP protocol';}if(!(Object.entries(settingsErrors).length===0)){_context2.next=14;break;}return _context2.abrupt(\"return\",null);case 14:return _context2.abrupt(\"return\",settingsErrors);case 15:case\"end\":return _context2.stop();}}},_callee2,null,[[1,6]]);}));return _validateNetworkSettings.apply(this,arguments);}var Label=styled.label.withConfig({displayName:\"Network__Label\",componentId:\"m2vdws-4\"})([\"color:\",\";display:block;margin-bottom:\",\"px;\"],function(_ref7){var theme=_ref7.theme;return theme.content;},2*GU);export default/*#__PURE__*/React.memo(Network);","map":{"version":3,"sources":["/Users/fabianmolina/Documents/1hive/tulip-frontend/src/components/GlobalPreferences/Network/Network.js"],"names":["React","useCallback","useState","styled","Box","Button","GU","TextInput","textStyle","useLayout","useTheme","defaultEthNode","defaultIpfsGateway","defaultSubgraphHttpEndpoint","clearLocalStorageNetworkSettings","setDefaultEthNode","setIpfsGateway","setSubgraphHttpEndpoint","InvalidNetworkType","InvalidURI","NoConnection","checkValidEthNode","getNetworkType","sanitizeNetworkType","validHttpFormat","useEnterKey","useSubgraph","Network","useNetwork","ethNode","handleClearNetworkSettings","handleEthNodeChange","handleIpfsGatewayChange","handleNetworkChange","handleSubgraphHttpEndpointChange","ipfsGateway","settingsErrors","subgraphHttpEndpoint","layoutName","compact","ethError","httpSubgraphError","Field","label","text","onTextChange","error","theme","contentSecondary","negative","setSettingsErrors","setEthNodeValue","setIpfsGatewayValue","setSubgraphHttpEndpointValue","resetSubgraphClient","networkType","subgraphChanged","defaultsChanged","validateNetworkSettings","errors","window","location","reload","value","currentTarget","Object","entries","length","Label","content","memo"],"mappings":"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","sourcesContent":["import React, { useCallback, useState } from 'react'\r\nimport styled from 'styled-components'\r\nimport {\r\n  Box,\r\n  Button,\r\n  GU,\r\n  TextInput,\r\n  textStyle,\r\n  useLayout,\r\n  useTheme,\r\n} from '@1hive/1hive-ui'\r\nimport {\r\n  defaultEthNode,\r\n  defaultIpfsGateway,\r\n  defaultSubgraphHttpEndpoint,\r\n} from '../../../endpoints'\r\nimport {\r\n  clearLocalStorageNetworkSettings,\r\n  setDefaultEthNode,\r\n  setIpfsGateway,\r\n  setSubgraphHttpEndpoint,\r\n} from '../../../local-settings'\r\nimport { InvalidNetworkType, InvalidURI, NoConnection } from '../../../errors'\r\nimport {\r\n  checkValidEthNode,\r\n  getNetworkType,\r\n  sanitizeNetworkType,\r\n} from '../../../lib/web3-utils'\r\nimport { validHttpFormat } from '../../../lib/uri-utils'\r\nimport { useEnterKey } from '../../../hooks/useKeyboardArrows'\r\nimport { useSubgraph } from '../../../providers/Subgraph'\r\n\r\nfunction Network() {\r\n  const {\r\n    ethNode,\r\n    handleClearNetworkSettings,\r\n    handleEthNodeChange,\r\n    handleIpfsGatewayChange,\r\n    handleNetworkChange,\r\n    handleSubgraphHttpEndpointChange,\r\n    ipfsGateway,\r\n    settingsErrors,\r\n    subgraphHttpEndpoint,\r\n  } = useNetwork()\r\n\r\n  const { layoutName } = useLayout()\r\n  const compact = layoutName === 'small'\r\n  const { ethError, httpSubgraphError } = settingsErrors || {}\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Box heading=\"Node settings\">\r\n        <Field\r\n          label=\"Ethereum node\"\r\n          text={ethNode}\r\n          onTextChange={handleEthNodeChange}\r\n          error={ethError}\r\n        />\r\n        <Field\r\n          label=\"IPFS Gateway\"\r\n          text={ipfsGateway}\r\n          onTextChange={handleIpfsGatewayChange}\r\n        />\r\n        <Field\r\n          label=\"Subgraph HTTP endpoint\"\r\n          text={subgraphHttpEndpoint}\r\n          onTextChange={handleSubgraphHttpEndpointChange}\r\n          error={httpSubgraphError}\r\n        />\r\n        <Button mode=\"strong\" onClick={handleNetworkChange} wide={compact}>\r\n          Save changes\r\n        </Button>\r\n      </Box>\r\n      <Box heading=\"Troubleshooting\">\r\n        <div\r\n          css={`\r\n            margin-bottom: ${2 * GU}px;\r\n          `}\r\n        >\r\n          <span>\r\n            Press this button to reset the network settings to their defaults.\r\n          </span>\r\n        </div>\r\n        <Button\r\n          css={`\r\n            margin-bottom: ${2 * GU}px;\r\n          `}\r\n          onClick={handleClearNetworkSettings}\r\n          wide={compact}\r\n        >\r\n          Reset network settings\r\n        </Button>\r\n      </Box>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\nfunction Field({ label, text, onTextChange, error }) {\r\n  const theme = useTheme()\r\n  return (\r\n    <Label theme={theme}>\r\n      {label}\r\n      <TextInput\r\n        value={text}\r\n        wide\r\n        onChange={onTextChange}\r\n        css={`\r\n          ${textStyle('body2')};\r\n          color: ${theme.contentSecondary};\r\n        `}\r\n      />\r\n      {error && (\r\n        <span\r\n          css={`\r\n            ${textStyle('body4')};\r\n            color: ${theme.negative};\r\n          `}\r\n        >\r\n          {error}\r\n        </span>\r\n      )}\r\n    </Label>\r\n  )\r\n}\r\n\r\nconst useNetwork = () => {\r\n  const [settingsErrors, setSettingsErrors] = useState(null)\r\n  const [ethNode, setEthNodeValue] = useState(defaultEthNode)\r\n  const [ipfsGateway, setIpfsGatewayValue] = useState(defaultIpfsGateway)\r\n  const [subgraphHttpEndpoint, setSubgraphHttpEndpointValue] = useState(\r\n    defaultSubgraphHttpEndpoint\r\n  )\r\n\r\n  const { resetSubgraphClient } = useSubgraph()\r\n  const networkType = getNetworkType()\r\n\r\n  const subgraphChanged = subgraphHttpEndpoint !== defaultSubgraphHttpEndpoint\r\n\r\n  const defaultsChanged =\r\n    ipfsGateway !== defaultIpfsGateway ||\r\n    ethNode !== defaultEthNode ||\r\n    subgraphChanged\r\n\r\n  const handleNetworkChange = useCallback(async () => {\r\n    if (!defaultsChanged) {\r\n      setSettingsErrors(null)\r\n      return\r\n    }\r\n\r\n    const errors = await validateNetworkSettings(\r\n      ethNode,\r\n      subgraphHttpEndpoint,\r\n      networkType\r\n    )\r\n\r\n    if (errors) {\r\n      setSettingsErrors(errors)\r\n      return\r\n    }\r\n    setDefaultEthNode(ethNode)\r\n    setSubgraphHttpEndpoint(subgraphHttpEndpoint)\r\n    setIpfsGateway(ipfsGateway)\r\n\r\n    if (subgraphChanged) {\r\n      resetSubgraphClient()\r\n    }\r\n    window.location.reload()\r\n  }, [\r\n    defaultsChanged,\r\n    ethNode,\r\n    subgraphHttpEndpoint,\r\n    networkType,\r\n    ipfsGateway,\r\n    subgraphChanged,\r\n    resetSubgraphClient,\r\n  ])\r\n\r\n  const handleClearNetworkSettings = useCallback(() => {\r\n    clearLocalStorageNetworkSettings()\r\n    window.location.reload()\r\n  }, [])\r\n\r\n  useEnterKey(handleNetworkChange)\r\n\r\n  return {\r\n    ethNode,\r\n    ipfsGateway,\r\n    subgraphHttpEndpoint,\r\n    handleNetworkChange,\r\n    handleClearNetworkSettings,\r\n    settingsErrors,\r\n    handleEthNodeChange: ({ currentTarget: { value } }) =>\r\n      setEthNodeValue(value),\r\n    handleIpfsGatewayChange: ({ currentTarget: { value } }) =>\r\n      setIpfsGatewayValue(value),\r\n    handleSubgraphHttpEndpointChange: ({ currentTarget: { value } }) =>\r\n      setSubgraphHttpEndpointValue(value),\r\n  }\r\n}\r\n\r\nasync function validateNetworkSettings(\r\n  ethNode,\r\n  subgraphHttpEndpoint,\r\n  networkType\r\n) {\r\n  const settingsErrors = {}\r\n  try {\r\n    await checkValidEthNode(ethNode)\r\n  } catch (err) {\r\n    if (err instanceof InvalidNetworkType) {\r\n      settingsErrors.ethError = `Node must be connected to ${sanitizeNetworkType(\r\n        networkType\r\n      )}`\r\n    }\r\n    if (err instanceof InvalidURI) {\r\n      settingsErrors.ethError = 'Must provide HTTP endpoint to node'\r\n    }\r\n    if (err instanceof NoConnection) {\r\n      settingsErrors.ethError = 'Could not connect to node'\r\n    }\r\n\r\n    if (!validHttpFormat(subgraphHttpEndpoint)) {\r\n      settingsErrors.httpSubgraphError = 'The URI must use the HTTP protocol'\r\n    }\r\n\r\n    if (Object.entries(settingsErrors).length === 0) {\r\n      return null\r\n    }\r\n    return settingsErrors\r\n  }\r\n}\r\n\r\nconst Label = styled.label`\r\n  color: ${({ theme }) => theme.content};\r\n  display: block;\r\n  margin-bottom: ${2 * GU}px;\r\n`\r\n\r\nexport default React.memo(Network)\r\n"]},"metadata":{},"sourceType":"module"}