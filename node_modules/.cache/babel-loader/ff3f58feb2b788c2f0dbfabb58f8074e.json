{"ast":null,"code":"'use strict'; // load websocket library if we are not in the browser\n\nvar WebSocket = require('./web-socket');\n\nvar duplex = require('./duplex');\n\nvar wsurl = require('./ws-url');\n\nmodule.exports = function (addr, opts = {}) {\n  const location = typeof window === 'undefined' ? {} : window.location;\n  const url = wsurl(addr, location);\n  const socket = new WebSocket(url, opts.websocket);\n  const stream = duplex(socket, opts);\n  stream.remoteAddress = url;\n\n  stream.close = () => new Promise((resolve, reject) => {\n    socket.addEventListener('close', resolve);\n    socket.close();\n  });\n\n  stream.destroy = () => {\n    if (socket.terminate) {\n      socket.terminate();\n    } else {\n      socket.close();\n    }\n  };\n\n  stream.socket = socket;\n  return stream;\n};\n\nmodule.exports.connect = module.exports;","map":null,"metadata":{},"sourceType":"script"}