{"ast":null,"code":"import _classCallCheck from\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import _defineProperty from\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import React from'react';import{captureException,showReportDialog}from'@sentry/browser';import GenericError from'./components/Errors/GenericError';import GlobalErrorScreen from'./components/Errors/GlobalErrorScreen';import{sentryEnabled}from'./sentry';var GlobalErrorHandler=/*#__PURE__*/function(_React$Component){_inherits(GlobalErrorHandler,_React$Component);var _super=_createSuper(GlobalErrorHandler);function GlobalErrorHandler(){var _this;_classCallCheck(this,GlobalErrorHandler);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_defineProperty(_assertThisInitialized(_this),\"state\",{error:null,errorStack:null});_defineProperty(_assertThisInitialized(_this),\"handleReportClick\",function(){if(sentryEnabled){var eventId=captureException(_this.state.error);showReportDialog({eventId:eventId});}});_defineProperty(_assertThisInitialized(_this),\"handleHashchange\",function(){window.location.reload();});return _this;}_createClass(GlobalErrorHandler,[{key:\"componentDidCatch\",value:function componentDidCatch(error,errorInfo){this.setState({error:error,errorStack:errorInfo.componentStack.replace(/^\\n+|\\n+$/g,'').replace(/^ {4}/gm,'')});// Once this point is reached, the app can not recover because the routing\n// system, being below this component in the tree, is not functional\n// anymore. To make hash changes work despite this (e.g. by pressing the\n// back button in the browser), the page need to be reloaded.\nwindow.removeEventListener('hashchange',this.handleHashchange);window.addEventListener('hashchange',this.handleHashchange);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){window.removeEventListener('hashchange',this.handleHashchange);}},{key:\"render\",value:function render(){var children=this.props.children;var _this$state=this.state,error=_this$state.error,errorStack=_this$state.errorStack;return error?/*#__PURE__*/React.createElement(GlobalErrorScreen,null,/*#__PURE__*/React.createElement(GenericError,{detailsTitle:error.message,detailsContent:errorStack,reportCallback:this.handleReportClick})):children;}}]);return GlobalErrorHandler;}(React.Component);export default GlobalErrorHandler;","map":{"version":3,"sources":["/Users/fabianmolina/Documents/1hive/tulip-frontend/src/GlobalErrorHandler.js"],"names":["React","captureException","showReportDialog","GenericError","GlobalErrorScreen","sentryEnabled","GlobalErrorHandler","error","errorStack","eventId","state","window","location","reload","errorInfo","setState","componentStack","replace","removeEventListener","handleHashchange","addEventListener","children","props","message","handleReportClick","Component"],"mappings":"w/BAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CAEA,OAASC,gBAAT,CAA2BC,gBAA3B,KAAmD,iBAAnD,CACA,MAAOC,CAAAA,YAAP,KAAyB,kCAAzB,CACA,MAAOC,CAAAA,iBAAP,KAA8B,uCAA9B,CACA,OAASC,aAAT,KAA8B,UAA9B,C,GAEMC,CAAAA,kB,uaAKI,CAAEC,KAAK,CAAE,IAAT,CAAeC,UAAU,CAAE,IAA3B,C,oEAsBY,UAAM,CACxB,GAAIH,aAAJ,CAAmB,CACjB,GAAMI,CAAAA,OAAO,CAAGR,gBAAgB,CAAC,MAAKS,KAAL,CAAWH,KAAZ,CAAhC,CACAL,gBAAgB,CAAC,CAAEO,OAAO,CAAPA,OAAF,CAAD,CAAhB,CACD,CACF,C,mEAEkB,UAAM,CACvBE,MAAM,CAACC,QAAP,CAAgBC,MAAhB,GACD,C,gFA7BD,2BAAkBN,KAAlB,CAAyBO,SAAzB,CAAoC,CAClC,KAAKC,QAAL,CAAc,CACZR,KAAK,CAALA,KADY,CAEZC,UAAU,CAAEM,SAAS,CAACE,cAAV,CACTC,OADS,CACD,YADC,CACa,EADb,EAETA,OAFS,CAED,SAFC,CAEU,EAFV,CAFA,CAAd,EAOA;AACA;AACA;AACA;AACAN,MAAM,CAACO,mBAAP,CAA2B,YAA3B,CAAyC,KAAKC,gBAA9C,EACAR,MAAM,CAACS,gBAAP,CAAwB,YAAxB,CAAsC,KAAKD,gBAA3C,EACD,C,oCAED,+BAAuB,CACrBR,MAAM,CAACO,mBAAP,CAA2B,YAA3B,CAAyC,KAAKC,gBAA9C,EACD,C,sBAaD,iBAAS,IACCE,CAAAA,QADD,CACc,KAAKC,KADnB,CACCD,QADD,iBAEuB,KAAKX,KAF5B,CAECH,KAFD,aAECA,KAFD,CAEQC,UAFR,aAEQA,UAFR,CAIP,MAAOD,CAAAA,KAAK,cACV,oBAAC,iBAAD,mBACE,oBAAC,YAAD,EACE,YAAY,CAAEA,KAAK,CAACgB,OADtB,CAEE,cAAc,CAAEf,UAFlB,CAGE,cAAc,CAAE,KAAKgB,iBAHvB,EADF,CADU,CASVH,QATF,CAWD,C,gCArD8BrB,KAAK,CAACyB,S,EAwDvC,cAAenB,CAAAA,kBAAf","sourcesContent":["import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport { captureException, showReportDialog } from '@sentry/browser'\r\nimport GenericError from './components/Errors/GenericError'\r\nimport GlobalErrorScreen from './components/Errors/GlobalErrorScreen'\r\nimport { sentryEnabled } from './sentry'\r\n\r\nclass GlobalErrorHandler extends React.Component {\r\n  static propTypes = {\r\n    children: PropTypes.node,\r\n  }\r\n\r\n  state = { error: null, errorStack: null }\r\n\r\n  componentDidCatch(error, errorInfo) {\r\n    this.setState({\r\n      error,\r\n      errorStack: errorInfo.componentStack\r\n        .replace(/^\\n+|\\n+$/g, '')\r\n        .replace(/^ {4}/gm, ''),\r\n    })\r\n\r\n    // Once this point is reached, the app can not recover because the routing\r\n    // system, being below this component in the tree, is not functional\r\n    // anymore. To make hash changes work despite this (e.g. by pressing the\r\n    // back button in the browser), the page need to be reloaded.\r\n    window.removeEventListener('hashchange', this.handleHashchange)\r\n    window.addEventListener('hashchange', this.handleHashchange)\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener('hashchange', this.handleHashchange)\r\n  }\r\n\r\n  handleReportClick = () => {\r\n    if (sentryEnabled) {\r\n      const eventId = captureException(this.state.error)\r\n      showReportDialog({ eventId })\r\n    }\r\n  }\r\n\r\n  handleHashchange = () => {\r\n    window.location.reload()\r\n  }\r\n\r\n  render() {\r\n    const { children } = this.props\r\n    const { error, errorStack } = this.state\r\n\r\n    return error ? (\r\n      <GlobalErrorScreen>\r\n        <GenericError\r\n          detailsTitle={error.message}\r\n          detailsContent={errorStack}\r\n          reportCallback={this.handleReportClick}\r\n        />\r\n      </GlobalErrorScreen>\r\n    ) : (\r\n      children\r\n    )\r\n  }\r\n}\r\n\r\nexport default GlobalErrorHandler\r\n"]},"metadata":{},"sourceType":"module"}