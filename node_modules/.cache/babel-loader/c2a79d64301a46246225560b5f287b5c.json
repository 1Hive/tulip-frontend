{"ast":null,"code":"'use strict';\n/**\n * SortedMap is a Map whose iterator order can be defined by the user\n */\n\nvar _regeneratorRuntime = require(\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\");\n\nvar _slicedToArray = require(\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/slicedToArray\");\n\nvar _createForOfIteratorHelper = require(\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createForOfIteratorHelper\");\n\nvar _classCallCheck = require(\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nvar _get = require(\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/get\");\n\nvar _getPrototypeOf = require(\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/getPrototypeOf\");\n\nvar _inherits = require(\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/inherits\");\n\nvar _createSuper = require(\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createSuper\");\n\nvar _wrapNativeSuper = require(\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/wrapNativeSuper\");\n\nvar SortedMap = /*#__PURE__*/function (_Map) {\n  _inherits(SortedMap, _Map);\n\n  var _super = _createSuper(SortedMap);\n\n  /**\n   * @param {Array<k, v>} [entries]\n   * @param {function(a, b)} [cmp] compares [k1, v1] to [k2, v2]\n   */\n  function SortedMap(entries, cmp) {\n    var _this;\n\n    _classCallCheck(this, SortedMap);\n\n    _this = _super.call(this);\n    _this._cmp = cmp || _this._defaultSort;\n    _this._keys = [];\n\n    var _iterator = _createForOfIteratorHelper(entries || []),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var _step$value = _slicedToArray(_step.value, 2),\n            k = _step$value[0],\n            v = _step$value[1];\n\n        _this.set(k, v);\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n\n    return _this;\n  }\n  /**\n   * Call update to update the position of the key when it should change.\n   * For example if the compare function sorts by the priority field, and the\n   * priority changes, call update.\n   * Call indexOf() to get the index _before_ the change happens.\n   *\n   * @param {Object} i - the index of entry whose position should be updated.\n   */\n\n\n  _createClass(SortedMap, [{\n    key: \"update\",\n    value: function update(i) {\n      if (i < 0 || i >= this._keys.length) {\n        return;\n      }\n\n      var k = this._keys[i];\n\n      this._keys.splice(i, 1);\n\n      var newIdx = this._find(k);\n\n      this._keys.splice(newIdx, 0, k);\n    }\n  }, {\n    key: \"set\",\n    value: function set(k, v) {\n      // If the key is already in the map, remove it from the ordering and\n      // re-insert it below\n      if (this.has(k)) {\n        var _i = this.indexOf(k);\n\n        this._keys.splice(_i, 1);\n      } // Update / insert the k/v into the map\n\n\n      _get(_getPrototypeOf(SortedMap.prototype), \"set\", this).call(this, k, v); // Find the correct position of the newly inserted k/v in the order\n\n\n      var i = this._find(k);\n\n      this._keys.splice(i, 0, k);\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      _get(_getPrototypeOf(SortedMap.prototype), \"clear\", this).call(this);\n\n      this._keys = [];\n    }\n  }, {\n    key: \"delete\",\n    value: function _delete(k) {\n      if (!this.has(k)) {\n        return;\n      }\n\n      var i = this.indexOf(k);\n\n      this._keys.splice(i, 1);\n\n      _get(_getPrototypeOf(SortedMap.prototype), \"delete\", this).call(this, k);\n    }\n  }, {\n    key: \"indexOf\",\n    value: function indexOf(k) {\n      if (!this.has(k)) {\n        return -1;\n      }\n\n      var i = this._find(k);\n\n      if (this._keys[i] === k) {\n        return i;\n      } // There may be more than one key with the same ordering\n      // eg { k1: <priority 5>, k2: <priority 5> }\n      // so scan outwards until the key matches\n\n\n      for (var j = 1; j < this._keys.length; j++) {\n        if (this._keys[i + j] === k) return i + j;\n        if (this._keys[i - j] === k) return i - j;\n      }\n\n      return -1; // should never happen for existing key\n    }\n  }, {\n    key: \"_find\",\n    value: function _find(k) {\n      var lower = 0;\n      var upper = this._keys.length;\n\n      while (lower < upper) {\n        var pivot = lower + upper >>> 1; // lower + (upper - lower) / 2\n\n        var cmp = this._kCmp(this._keys[pivot], k); // console.log(`  _find ${lower}:${upper}[${pivot}] ${cmp}`)\n\n\n        if (cmp < 0) {\n          // pivot < k\n          lower = pivot + 1;\n        } else if (cmp > 0) {\n          // pivot > k\n          upper = pivot;\n        } else {\n          // pivot == k\n          return pivot;\n        }\n      }\n\n      return lower;\n    }\n  }, {\n    key: \"keys\",\n    value: /*#__PURE__*/_regeneratorRuntime.mark(function keys() {\n      var _iterator2, _step2, k;\n\n      return _regeneratorRuntime.wrap(function keys$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _iterator2 = _createForOfIteratorHelper(this._keys);\n              _context.prev = 1;\n\n              _iterator2.s();\n\n            case 3:\n              if ((_step2 = _iterator2.n()).done) {\n                _context.next = 9;\n                break;\n              }\n\n              k = _step2.value;\n              _context.next = 7;\n              return k;\n\n            case 7:\n              _context.next = 3;\n              break;\n\n            case 9:\n              _context.next = 14;\n              break;\n\n            case 11:\n              _context.prev = 11;\n              _context.t0 = _context[\"catch\"](1);\n\n              _iterator2.e(_context.t0);\n\n            case 14:\n              _context.prev = 14;\n\n              _iterator2.f();\n\n              return _context.finish(14);\n\n            case 17:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, keys, this, [[1, 11, 14, 17]]);\n    })\n  }, {\n    key: \"values\",\n    value: /*#__PURE__*/_regeneratorRuntime.mark(function values() {\n      var _iterator3, _step3, k;\n\n      return _regeneratorRuntime.wrap(function values$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _iterator3 = _createForOfIteratorHelper(this._keys);\n              _context2.prev = 1;\n\n              _iterator3.s();\n\n            case 3:\n              if ((_step3 = _iterator3.n()).done) {\n                _context2.next = 9;\n                break;\n              }\n\n              k = _step3.value;\n              _context2.next = 7;\n              return this.get(k);\n\n            case 7:\n              _context2.next = 3;\n              break;\n\n            case 9:\n              _context2.next = 14;\n              break;\n\n            case 11:\n              _context2.prev = 11;\n              _context2.t0 = _context2[\"catch\"](1);\n\n              _iterator3.e(_context2.t0);\n\n            case 14:\n              _context2.prev = 14;\n\n              _iterator3.f();\n\n              return _context2.finish(14);\n\n            case 17:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, values, this, [[1, 11, 14, 17]]);\n    })\n  }, {\n    key: \"entries\",\n    value: /*#__PURE__*/_regeneratorRuntime.mark(function entries() {\n      var _iterator4, _step4, k;\n\n      return _regeneratorRuntime.wrap(function entries$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _iterator4 = _createForOfIteratorHelper(this._keys);\n              _context3.prev = 1;\n\n              _iterator4.s();\n\n            case 3:\n              if ((_step4 = _iterator4.n()).done) {\n                _context3.next = 9;\n                break;\n              }\n\n              k = _step4.value;\n              _context3.next = 7;\n              return [k, this.get(k)];\n\n            case 7:\n              _context3.next = 3;\n              break;\n\n            case 9:\n              _context3.next = 14;\n              break;\n\n            case 11:\n              _context3.prev = 11;\n              _context3.t0 = _context3[\"catch\"](1);\n\n              _iterator4.e(_context3.t0);\n\n            case 14:\n              _context3.prev = 14;\n\n              _iterator4.f();\n\n              return _context3.finish(14);\n\n            case 17:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, entries, this, [[1, 11, 14, 17]]);\n    })\n  }, {\n    key: Symbol.iterator,\n    value: /*#__PURE__*/_regeneratorRuntime.mark(function value() {\n      return _regeneratorRuntime.wrap(function value$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              return _context4.delegateYield(this.entries(), \"t0\", 1);\n\n            case 1:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, value, this);\n    })\n  }, {\n    key: \"forEach\",\n    value: function forEach(cb, thisArg) {\n      if (!cb) {\n        return;\n      }\n\n      var _iterator5 = _createForOfIteratorHelper(this._keys),\n          _step5;\n\n      try {\n        for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n          var k = _step5.value;\n          cb.apply(thisArg, [[k, this.get(k)]]);\n        }\n      } catch (err) {\n        _iterator5.e(err);\n      } finally {\n        _iterator5.f();\n      }\n    }\n  }, {\n    key: \"_defaultSort\",\n    value: function _defaultSort(a, b) {\n      if (a[0] < b[0]) return -1;\n      if (b[0] < a[0]) return 1;\n      return 0;\n    }\n  }, {\n    key: \"_kCmp\",\n    value: function _kCmp(a, b) {\n      return this._cmp([a, this.get(a)], [b, this.get(b)]);\n    }\n  }]);\n\n  return SortedMap;\n}( /*#__PURE__*/_wrapNativeSuper(Map));\n\nmodule.exports = SortedMap;","map":null,"metadata":{},"sourceType":"script"}