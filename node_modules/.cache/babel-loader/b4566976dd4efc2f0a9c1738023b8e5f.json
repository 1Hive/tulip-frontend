{"ast":null,"code":"'use strict';\n\nconst Repo = require('ipfs-repo');\n\nconst {\n  withTimeoutOption\n} = require('../../utils');\n\nmodule.exports = function ({\n  repo\n}) {\n  return withTimeoutOption(async function* refsLocal(options = {}) {\n    for await (const result of repo.blocks.query({\n      keysOnly: true,\n      signal: options.signal\n    })) {\n      yield dsKeyToRef(result.key);\n    }\n  });\n};\n\nfunction dsKeyToRef(key) {\n  try {\n    return {\n      ref: Repo.utils.blockstore.keyToCid(key).toString()\n    };\n  } catch (err) {\n    return {\n      err: `Could not convert block with key '${key}' to CID: ${err.message}`\n    };\n  }\n}","map":null,"metadata":{},"sourceType":"script"}