{"ast":null,"code":"'use strict';\n\nvar ciphers = require('./ciphers');\n\nvar CIPHER_MODES = {\n  16: 'aes-128-ctr',\n  32: 'aes-256-ctr'\n};\n\nexports.create = function (key, iv, callback) {\n  var mode = CIPHER_MODES[key.length];\n\n  if (!mode) {\n    return callback(new Error('Invalid key length'));\n  }\n\n  var cipher = ciphers.createCipheriv(mode, key, iv);\n  var decipher = ciphers.createDecipheriv(mode, key, iv);\n  var res = {\n    encrypt: function encrypt(data, cb) {\n      cb(null, cipher.update(data));\n    },\n    decrypt: function decrypt(data, cb) {\n      cb(null, decipher.update(data));\n    }\n  };\n  callback(null, res);\n};","map":null,"metadata":{},"sourceType":"script"}