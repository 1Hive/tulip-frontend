{"ast":null,"code":"var _objectSpread = require(\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/objectSpread2\");\n\nvar _regeneratorRuntime = require(\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\");\n\nvar _taggedTemplateLiteral = require(\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/taggedTemplateLiteral\");\n\nvar _asyncToGenerator = require(\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/asyncToGenerator\");\n\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5, _templateObject6;\n\nvar pageResults = require('graph-results-pager');\n\nvar ws = require('isomorphic-ws');\n\nvar _require = require('subscriptions-transport-ws'),\n    SubscriptionClient = _require.SubscriptionClient;\n\nvar _require2 = require('graphql-request'),\n    request = _require2.request,\n    gql = _require2.gql;\n\nvar _require3 = require(\"date-fns\"),\n    subWeeks = _require3.subWeeks,\n    getUnixTime = _require3.getUnixTime,\n    fromUnixTime = _require3.fromUnixTime;\n\nvar _require4 = require('./../../constants'),\n    graphAPIEndpoints = _require4.graphAPIEndpoints,\n    graphWSEndpoints = _require4.graphWSEndpoints,\n    TWENTY_FOUR_HOURS = _require4.TWENTY_FOUR_HOURS;\n\nvar _require5 = require('./../../utils'),\n    timestampToBlock = _require5.timestampToBlock,\n    timestampsToBlocks = _require5.timestampsToBlocks,\n    blockToTimestamp = _require5.blockToTimestamp;\n\nvar _require6 = require('./../exchange/eth'),\n    ethPrice = _require6.ethPrice;\n\nmodule.exports = {\n  pair: function pair() {\n    var _arguments = arguments;\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _ref, _ref$block, block, _ref$timestamp, timestamp, _ref$pair_address, pair_address, result;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _ref = _arguments.length > 0 && _arguments[0] !== undefined ? _arguments[0] : {}, _ref$block = _ref.block, block = _ref$block === void 0 ? undefined : _ref$block, _ref$timestamp = _ref.timestamp, timestamp = _ref$timestamp === void 0 ? undefined : _ref$timestamp, _ref$pair_address = _ref.pair_address, pair_address = _ref$pair_address === void 0 ? undefined : _ref$pair_address;\n\n              if (pair_address) {\n                _context.next = 3;\n                break;\n              }\n\n              throw new Error(\"sushi-data: Pair address undefined\");\n\n            case 3:\n              if (!block) {\n                _context.next = 7;\n                break;\n              }\n\n              _context.t0 = block;\n              _context.next = 15;\n              break;\n\n            case 7:\n              if (!timestamp) {\n                _context.next = 13;\n                break;\n              }\n\n              _context.next = 10;\n              return timestampToBlock(timestamp);\n\n            case 10:\n              _context.t1 = _context.sent;\n              _context.next = 14;\n              break;\n\n            case 13:\n              _context.t1 = undefined;\n\n            case 14:\n              _context.t0 = _context.t1;\n\n            case 15:\n              block = _context.t0;\n              block = block ? \"block: { number: \".concat(block, \" }\") : \"\";\n              _context.next = 19;\n              return request(graphAPIEndpoints.exchange, gql(_templateObject || (_templateObject = _taggedTemplateLiteral([\"{\\n                    pair(id: \\\"\", \"\\\", \", \") {\\n                        \", \"\\n                    }\\n                }\"])), pair_address.toLowerCase(), block, _pairs.properties.toString()));\n\n            case 19:\n              result = _context.sent;\n              return _context.abrupt(\"return\", _pairs.callback([result.pair])[0]);\n\n            case 21:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }))();\n  },\n  pair24h: function pair24h() {\n    var _arguments2 = arguments;\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var _ref2, _ref2$block, block, _ref2$timestamp, timestamp, _ref2$pair_address, pair_address, timestampNow, result, result24ago, result48ago, ethPriceUSD, ethPriceUSD24ago;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _ref2 = _arguments2.length > 0 && _arguments2[0] !== undefined ? _arguments2[0] : {}, _ref2$block = _ref2.block, block = _ref2$block === void 0 ? undefined : _ref2$block, _ref2$timestamp = _ref2.timestamp, timestamp = _ref2$timestamp === void 0 ? undefined : _ref2$timestamp, _ref2$pair_address = _ref2.pair_address, pair_address = _ref2$pair_address === void 0 ? undefined : _ref2$pair_address;\n\n              if (pair_address) {\n                _context2.next = 3;\n                break;\n              }\n\n              throw new Error(\"sushi-data: Pair address undefined\");\n\n            case 3:\n              if (!timestamp) {\n                _context2.next = 7;\n                break;\n              }\n\n              _context2.t0 = timestamp;\n              _context2.next = 15;\n              break;\n\n            case 7:\n              if (!block) {\n                _context2.next = 13;\n                break;\n              }\n\n              _context2.next = 10;\n              return blockToTimestamp(block);\n\n            case 10:\n              _context2.t1 = _context2.sent;\n              _context2.next = 14;\n              break;\n\n            case 13:\n              _context2.t1 = Math.floor(Date.now() / 1000);\n\n            case 14:\n              _context2.t0 = _context2.t1;\n\n            case 15:\n              timestampNow = _context2.t0;\n              timestamp24ago = timestampNow - TWENTY_FOUR_HOURS;\n              timestamp48ago = timestamp24ago - TWENTY_FOUR_HOURS;\n\n              if (!timestamp) {\n                _context2.next = 24;\n                break;\n              }\n\n              _context2.next = 21;\n              return timestampToBlock(timestamp);\n\n            case 21:\n              _context2.t2 = _context2.sent;\n              _context2.next = 25;\n              break;\n\n            case 24:\n              _context2.t2 = block;\n\n            case 25:\n              block = _context2.t2;\n              _context2.next = 28;\n              return timestampToBlock(timestamp24ago);\n\n            case 28:\n              block24ago = _context2.sent;\n              _context2.next = 31;\n              return timestampToBlock(timestamp48ago);\n\n            case 31:\n              block48ago = _context2.sent;\n              _context2.next = 34;\n              return module.exports.pair({\n                block: block,\n                pair_address: pair_address\n              });\n\n            case 34:\n              result = _context2.sent;\n              _context2.next = 37;\n              return module.exports.pair({\n                block: block24ago,\n                pair_address: pair_address\n              });\n\n            case 37:\n              result24ago = _context2.sent;\n              _context2.next = 40;\n              return module.exports.pair({\n                block: block48ago,\n                pair_address: pair_address\n              });\n\n            case 40:\n              result48ago = _context2.sent;\n              _context2.next = 43;\n              return ethPrice({\n                block: block\n              });\n\n            case 43:\n              ethPriceUSD = _context2.sent;\n              _context2.next = 46;\n              return ethPrice({\n                block: block24ago\n              });\n\n            case 46:\n              ethPriceUSD24ago = _context2.sent;\n              return _context2.abrupt(\"return\", _pairs.callback24h([result], [result24ago], [result48ago], ethPriceUSD, ethPriceUSD24ago)[0]);\n\n            case 48:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }))();\n  },\n  pairHourData: function pairHourData() {\n    var _arguments3 = arguments;\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var _ref3, _ref3$minTimestamp, minTimestamp, _ref3$maxTimestamp, maxTimestamp, _ref3$minBlock, minBlock, _ref3$maxBlock, maxBlock, _ref3$pair_address, pair_address, endTime, time, timestamps, blocks, query, result;\n\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _ref3 = _arguments3.length > 0 && _arguments3[0] !== undefined ? _arguments3[0] : {}, _ref3$minTimestamp = _ref3.minTimestamp, minTimestamp = _ref3$minTimestamp === void 0 ? undefined : _ref3$minTimestamp, _ref3$maxTimestamp = _ref3.maxTimestamp, maxTimestamp = _ref3$maxTimestamp === void 0 ? undefined : _ref3$maxTimestamp, _ref3$minBlock = _ref3.minBlock, minBlock = _ref3$minBlock === void 0 ? undefined : _ref3$minBlock, _ref3$maxBlock = _ref3.maxBlock, maxBlock = _ref3$maxBlock === void 0 ? undefined : _ref3$maxBlock, _ref3$pair_address = _ref3.pair_address, pair_address = _ref3$pair_address === void 0 ? undefined : _ref3$pair_address;\n\n              if (pair_address) {\n                _context3.next = 3;\n                break;\n              }\n\n              throw new Error(\"sushi-data: Pair address undefined\");\n\n            case 3:\n              minTimestamp = minBlock ? blockToTimestamp(minBlock) : minTimestamp;\n              maxTimestamp = maxBlock ? blockToTimestamp(maxBlock) : maxTimestamp;\n              endTime = maxTimestamp ? fromUnixTime(maxTimestamp) : new Date();\n              time = minTimestamp ? minTimestamp : getUnixTime(subWeeks(endTime, 1)); // create an array of hour start times until we reach current hour\n\n              timestamps = [];\n\n              while (time <= getUnixTime(endTime) - 3600) {\n                timestamps.push(time);\n                time += 3600;\n              }\n\n              _context3.next = 11;\n              return timestampsToBlocks(timestamps);\n\n            case 11:\n              blocks = _context3.sent;\n              query = gql(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"{\\n                \", \"\\n            }\"])), blocks.map(function (block, i) {\n                return gql(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\n                    timestamp\", \": pair(id: \\\"\", \"\\\", block: {number: \", \"}) {\\n                        \", \"\\n                }\"])), timestamps[i], pair_address.toLowerCase(), block, _pairs.properties.toString());\n              }));\n              _context3.next = 15;\n              return request(graphAPIEndpoints.exchange, query);\n\n            case 15:\n              result = _context3.sent;\n              result = Object.keys(result).map(function (key) {\n                return _objectSpread(_objectSpread({}, result[key]), {}, {\n                  timestamp: Number(key.split(\"timestamp\")[1])\n                });\n              }).sort(function (a, b) {\n                return a.timestamp - b.timestamp;\n              });\n              return _context3.abrupt(\"return\", _pairs.callbackHourData(result));\n\n            case 18:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }))();\n  },\n  pairDayData: function pairDayData() {\n    var _arguments4 = arguments;\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n      var _ref4, _ref4$minTimestamp, minTimestamp, _ref4$maxTimestamp, maxTimestamp, _ref4$minBlock, minBlock, _ref4$maxBlock, maxBlock, _ref4$pair_address, pair_address;\n\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _ref4 = _arguments4.length > 0 && _arguments4[0] !== undefined ? _arguments4[0] : {}, _ref4$minTimestamp = _ref4.minTimestamp, minTimestamp = _ref4$minTimestamp === void 0 ? undefined : _ref4$minTimestamp, _ref4$maxTimestamp = _ref4.maxTimestamp, maxTimestamp = _ref4$maxTimestamp === void 0 ? undefined : _ref4$maxTimestamp, _ref4$minBlock = _ref4.minBlock, minBlock = _ref4$minBlock === void 0 ? undefined : _ref4$minBlock, _ref4$maxBlock = _ref4.maxBlock, maxBlock = _ref4$maxBlock === void 0 ? undefined : _ref4$maxBlock, _ref4$pair_address = _ref4.pair_address, pair_address = _ref4$pair_address === void 0 ? undefined : _ref4$pair_address;\n\n              if (pair_address) {\n                _context4.next = 3;\n                break;\n              }\n\n              throw new Error(\"sushi-data: Pair address undefined\");\n\n            case 3:\n              _context4.t0 = pageResults;\n              _context4.t1 = graphAPIEndpoints.exchange;\n              _context4.t2 = \"\\\\\\\"\".concat(pair_address.toLowerCase(), \"\\\\\\\"\");\n              _context4.t3 = minTimestamp;\n\n              if (_context4.t3) {\n                _context4.next = 16;\n                break;\n              }\n\n              if (!minBlock) {\n                _context4.next = 14;\n                break;\n              }\n\n              _context4.next = 11;\n              return blockToTimestamp(minBlock);\n\n            case 11:\n              _context4.t4 = _context4.sent;\n              _context4.next = 15;\n              break;\n\n            case 14:\n              _context4.t4 = undefined;\n\n            case 15:\n              _context4.t3 = _context4.t4;\n\n            case 16:\n              _context4.t5 = _context4.t3;\n              _context4.t6 = maxTimestamp;\n\n              if (_context4.t6) {\n                _context4.next = 27;\n                break;\n              }\n\n              if (!maxBlock) {\n                _context4.next = 25;\n                break;\n              }\n\n              _context4.next = 22;\n              return blockToTimestamp(maxBlock);\n\n            case 22:\n              _context4.t7 = _context4.sent;\n              _context4.next = 26;\n              break;\n\n            case 25:\n              _context4.t7 = undefined;\n\n            case 26:\n              _context4.t6 = _context4.t7;\n\n            case 27:\n              _context4.t8 = _context4.t6;\n              _context4.t9 = {\n                pair: _context4.t2,\n                date_gte: _context4.t5,\n                date_lte: _context4.t8\n              };\n              _context4.t10 = {\n                orderDirection: 'desc',\n                where: _context4.t9\n              };\n              _context4.t11 = _pairs.propertiesDayData;\n              _context4.t12 = {\n                entity: 'pairDayDatas',\n                selection: _context4.t10,\n                properties: _context4.t11\n              };\n              _context4.t13 = {\n                api: _context4.t1,\n                query: _context4.t12\n              };\n              return _context4.abrupt(\"return\", (0, _context4.t0)(_context4.t13).then(function (results) {\n                return _pairs.callbackDayData(results);\n              }).catch(function (err) {\n                return console.log(err);\n              }));\n\n            case 34:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }))();\n  },\n  observePair: function observePair(_ref5) {\n    var _ref5$pair_address = _ref5.pair_address,\n        pair_address = _ref5$pair_address === void 0 ? undefined : _ref5$pair_address;\n\n    if (!pair_address) {\n      throw new Error(\"sushi-data: Pair address undefined\");\n    }\n\n    var query = gql(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"\\n            subscription {\\n                pair(id: \\\"\", \"\\\") {\\n                    \", \"\\n                }\\n            }\"])), pair_address.toLowerCase(), _pairs.properties.toString());\n    var client = new SubscriptionClient(graphWSEndpoints.exchange, {\n      reconnect: true\n    }, ws);\n    var observable = client.request({\n      query: query\n    });\n    return {\n      subscribe: function subscribe(_ref6) {\n        var _next = _ref6.next,\n            error = _ref6.error,\n            complete = _ref6.complete;\n        return observable.subscribe({\n          next: function next(results) {\n            _next(_pairs.callback([results.data.pair])[0]);\n          },\n          error: error,\n          complete: complete\n        });\n      }\n    };\n  },\n  pairs: function pairs() {\n    var _arguments5 = arguments;\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n      var _ref7, _ref7$block, block, _ref7$timestamp, timestamp, _ref7$max, max, _ref7$pair_addresses, pair_addresses, query, result;\n\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _ref7 = _arguments5.length > 0 && _arguments5[0] !== undefined ? _arguments5[0] : {}, _ref7$block = _ref7.block, block = _ref7$block === void 0 ? undefined : _ref7$block, _ref7$timestamp = _ref7.timestamp, timestamp = _ref7$timestamp === void 0 ? undefined : _ref7$timestamp, _ref7$max = _ref7.max, max = _ref7$max === void 0 ? undefined : _ref7$max, _ref7$pair_addresses = _ref7.pair_addresses, pair_addresses = _ref7$pair_addresses === void 0 ? undefined : _ref7$pair_addresses;\n\n              if (!pair_addresses) {\n                _context5.next = 23;\n                break;\n              }\n\n              if (!block) {\n                _context5.next = 6;\n                break;\n              }\n\n              _context5.t0 = block;\n              _context5.next = 14;\n              break;\n\n            case 6:\n              if (!timestamp) {\n                _context5.next = 12;\n                break;\n              }\n\n              _context5.next = 9;\n              return timestampToBlock(timestamp);\n\n            case 9:\n              _context5.t1 = _context5.sent;\n              _context5.next = 13;\n              break;\n\n            case 12:\n              _context5.t1 = undefined;\n\n            case 13:\n              _context5.t0 = _context5.t1;\n\n            case 14:\n              block = _context5.t0;\n              block = block ? \"block: { number: \".concat(block, \" }\") : \"\";\n              query = gql(_templateObject5 || (_templateObject5 = _taggedTemplateLiteral([\"{\\n                    \", \"\\n                }\"])), pair_addresses.map(function (pair, i) {\n                return \"\\n                        pair\".concat(i, \": pair(id: \\\"\").concat(pair.toLowerCase(), \"\\\", \").concat(block, \") {\\n                            \").concat(_pairs.properties.toString(), \"\\n                    }\");\n              }));\n              _context5.t2 = Object;\n              _context5.next = 20;\n              return request(graphAPIEndpoints.exchange, query);\n\n            case 20:\n              _context5.t3 = _context5.sent;\n              result = _context5.t2.values.call(_context5.t2, _context5.t3);\n              return _context5.abrupt(\"return\", _pairs.callback(result));\n\n            case 23:\n              _context5.t4 = pageResults;\n              _context5.t5 = graphAPIEndpoints.exchange;\n\n              if (!block) {\n                _context5.next = 29;\n                break;\n              }\n\n              _context5.t6 = {\n                number: block\n              };\n              _context5.next = 38;\n              break;\n\n            case 29:\n              if (!timestamp) {\n                _context5.next = 36;\n                break;\n              }\n\n              _context5.next = 32;\n              return timestampToBlock(timestamp);\n\n            case 32:\n              _context5.t8 = _context5.sent;\n              _context5.t7 = {\n                number: _context5.t8\n              };\n              _context5.next = 37;\n              break;\n\n            case 36:\n              _context5.t7 = undefined;\n\n            case 37:\n              _context5.t6 = _context5.t7;\n\n            case 38:\n              _context5.t9 = _context5.t6;\n              _context5.t10 = {\n                block: _context5.t9\n              };\n              _context5.t11 = _pairs.properties;\n              _context5.t12 = {\n                entity: 'pairs',\n                selection: _context5.t10,\n                properties: _context5.t11\n              };\n              _context5.t13 = max;\n              _context5.t14 = {\n                api: _context5.t5,\n                query: _context5.t12,\n                max: _context5.t13\n              };\n              return _context5.abrupt(\"return\", (0, _context5.t4)(_context5.t14).then(function (results) {\n                return _pairs.callback(results);\n              }).catch(function (err) {\n                return console.log(err);\n              }));\n\n            case 45:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }))();\n  },\n  pairs24h: function pairs24h() {\n    var _arguments6 = arguments;\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n      var _ref8, _ref8$block, block, _ref8$timestamp, timestamp, _ref8$max, max, timestampNow, results, results24ago, results48ago, ethPriceUSD, ethPriceUSD24ago;\n\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              _ref8 = _arguments6.length > 0 && _arguments6[0] !== undefined ? _arguments6[0] : {}, _ref8$block = _ref8.block, block = _ref8$block === void 0 ? undefined : _ref8$block, _ref8$timestamp = _ref8.timestamp, timestamp = _ref8$timestamp === void 0 ? undefined : _ref8$timestamp, _ref8$max = _ref8.max, max = _ref8$max === void 0 ? undefined : _ref8$max;\n\n              if (!timestamp) {\n                _context6.next = 5;\n                break;\n              }\n\n              _context6.t0 = timestamp;\n              _context6.next = 13;\n              break;\n\n            case 5:\n              if (!block) {\n                _context6.next = 11;\n                break;\n              }\n\n              _context6.next = 8;\n              return blockToTimestamp(block);\n\n            case 8:\n              _context6.t1 = _context6.sent;\n              _context6.next = 12;\n              break;\n\n            case 11:\n              _context6.t1 = Math.floor(Date.now() / 1000);\n\n            case 12:\n              _context6.t0 = _context6.t1;\n\n            case 13:\n              timestampNow = _context6.t0;\n              timestamp24ago = timestampNow - TWENTY_FOUR_HOURS;\n              timestamp48ago = timestamp24ago - TWENTY_FOUR_HOURS;\n\n              if (!timestamp) {\n                _context6.next = 22;\n                break;\n              }\n\n              _context6.next = 19;\n              return timestampToBlock(timestamp);\n\n            case 19:\n              _context6.t2 = _context6.sent;\n              _context6.next = 23;\n              break;\n\n            case 22:\n              _context6.t2 = block;\n\n            case 23:\n              block = _context6.t2;\n              _context6.next = 26;\n              return timestampToBlock(timestamp24ago);\n\n            case 26:\n              block24ago = _context6.sent;\n              _context6.next = 29;\n              return timestampToBlock(timestamp48ago);\n\n            case 29:\n              block48ago = _context6.sent;\n              _context6.next = 32;\n              return module.exports.pairs({\n                block: block,\n                max: max\n              });\n\n            case 32:\n              results = _context6.sent;\n              _context6.next = 35;\n              return module.exports.pairs({\n                block: block24ago,\n                max: max\n              });\n\n            case 35:\n              results24ago = _context6.sent;\n              _context6.next = 38;\n              return module.exports.pairs({\n                block: block48ago,\n                max: max\n              });\n\n            case 38:\n              results48ago = _context6.sent;\n              _context6.next = 41;\n              return ethPrice({\n                block: block\n              });\n\n            case 41:\n              ethPriceUSD = _context6.sent;\n              _context6.next = 44;\n              return ethPrice({\n                block: block24ago\n              });\n\n            case 44:\n              ethPriceUSD24ago = _context6.sent;\n              return _context6.abrupt(\"return\", _pairs.callback24h(results, results24ago, results48ago, ethPriceUSD, ethPriceUSD24ago));\n\n            case 46:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }))();\n  },\n  observePairs: function observePairs() {\n    var query = gql(_templateObject6 || (_templateObject6 = _taggedTemplateLiteral([\"\\n            subscription {\\n                pairs(first: 1000, orderBy: reserveUSD, orderDirection: desc) {\\n                    \", \"\\n                }\\n        }\"])), _pairs.properties.toString());\n    var client = new SubscriptionClient(graphWSEndpoints.exchange, {\n      reconnect: true\n    }, ws);\n    var observable = client.request({\n      query: query\n    });\n    return {\n      subscribe: function subscribe(_ref9) {\n        var _next2 = _ref9.next,\n            error = _ref9.error,\n            complete = _ref9.complete;\n        return observable.subscribe({\n          next: function next(results) {\n            _next2(_pairs.callback(results.data.pairs));\n          },\n          error: error,\n          complete: complete\n        });\n      }\n    };\n  }\n};\nvar _pairs = {\n  properties: ['id', 'token0 { id, name, symbol, totalSupply, derivedETH }', 'token1 { id, name, symbol, totalSupply, derivedETH }', 'reserve0', 'reserve1', 'totalSupply', 'reserveETH', 'reserveUSD', 'trackedReserveETH', 'token0Price', 'token1Price', 'volumeToken0', 'volumeToken1', 'volumeUSD', 'untrackedVolumeUSD', 'txCount'],\n  callback: function callback(results) {\n    return results.map(function (result) {\n      return {\n        id: result.id,\n        token0: {\n          id: result.token0.id,\n          name: result.token0.name,\n          symbol: result.token0.symbol,\n          totalSupply: Number(result.token0.totalSupply),\n          derivedETH: Number(result.token0.derivedETH)\n        },\n        token1: {\n          id: result.token1.id,\n          name: result.token1.name,\n          symbol: result.token1.symbol,\n          totalSupply: Number(result.token1.totalSupply),\n          derivedETH: Number(result.token1.derivedETH)\n        },\n        reserve0: Number(result.reserve0),\n        reserve1: Number(result.reserve1),\n        totalSupply: Number(result.totalSupply),\n        reserveETH: Number(result.reserveETH),\n        reserveUSD: Number(result.reserveUSD),\n        trackedReserveETH: Number(result.trackedReserveETH),\n        token0Price: Number(result.token0Price),\n        token1Price: Number(result.token1Price),\n        volumeToken0: Number(result.volumeToken0),\n        volumeToken1: Number(result.volumeToken1),\n        volumeUSD: Number(result.volumeUSD),\n        untrackedVolumeUSD: Number(result.untrackedVolumeUSD),\n        txCount: Number(result.txCount)\n      };\n    }).sort(function (a, b) {\n      return b.reserveUSD - a.reserveUSD;\n    });\n  },\n  callback24h: function callback24h(results, results24h, results48h, ethPriceUSD, ethPriceUSD24ago) {\n    return results.map(function (result) {\n      var result24h = results24h.find(function (e) {\n        return e.id === result.id;\n      }) || result;\n      var result48h = results48h.find(function (e) {\n        return e.id === result.id;\n      }) || result;\n      return _objectSpread(_objectSpread({}, result), {}, {\n        trackedReserveUSD: result.trackedReserveETH * ethPriceUSD,\n        trackedReserveUSDChange: result.trackedReserveETH * ethPriceUSD / (result24h.trackedReserveETH * ethPriceUSD24ago) * 100 - 100,\n        trackedReserveUSDChangeCount: result.trackedReserveETH * ethPriceUSD - result24h.trackedReserveETH * ethPriceUSD24ago,\n        trackedReserveETHChange: result.trackedReserveETH / result24h.trackedReserveETH * 100 - 100,\n        trackedReserveETHChangeCount: result.trackedReserveETH - result24h.trackedReserveETH,\n        volumeUSDOneDay: result.volumeUSD - result24h.volumeUSD,\n        volumeUSDChange: (result.volumeUSD - result24h.volumeUSD) / (result24h.volumeUSD - result48h.volumeUSD) * 100 - 100,\n        volumeUSDChangeCount: result.volumeUSD - result24h.volumeUSD - (result24h.volumeUSD - result48h.volumeUSD),\n        untrackedVolumeUSDOneDay: result.untrackedVolumeUSD - result24h.untrackedVolumeUSD,\n        untrackedVolumeUSDChange: (result.untrackedVolumeUSD - result24h.untrackedVolumeUSD) / (result24h.untrackedVolumeUSD - result48h.untrackedVolumeUSD) * 100 - 100,\n        untrackedVolumeUSDChangeCount: result.untrackedVolumeUSD - result24h.untrackedVolumeUSD - (result24h.untrackedVolumeUSD - result48h.untrackedVolumeUSD),\n        txCountOneDay: result.txCount - result24h.txCount,\n        txCountChange: (result.txCount - result24h.txCount) / (result24h.txCount - result48h.txCount) * 100 - 100,\n        txCountChangeCount: result.txCount - result24h.txCount - (result24h.txCount - result48h.txCount)\n      });\n    });\n  },\n  callbackHourData: function callbackHourData(results) {\n    return results.map(function (result) {\n      return {\n        id: result.id,\n        token0: {\n          id: result.token0.id,\n          name: result.token0.name,\n          symbol: result.token0.symbol,\n          totalSupply: Number(result.token0.totalSupply),\n          derivedETH: Number(result.token0.derivedETH)\n        },\n        token1: {\n          id: result.token1.id,\n          name: result.token1.name,\n          symbol: result.token1.symbol,\n          totalSupply: Number(result.token1.totalSupply),\n          derivedETH: Number(result.token1.derivedETH)\n        },\n        reserve0: Number(result.reserve0),\n        reserve1: Number(result.reserve1),\n        totalSupply: Number(result.totalSupply),\n        reserveETH: Number(result.reserveETH),\n        reserveUSD: Number(result.reserveUSD),\n        trackedReserveETH: Number(result.trackedReserveETH),\n        token0Price: Number(result.token0Price),\n        token1Price: Number(result.token1Price),\n        volumeToken0: Number(result.volumeToken0),\n        volumeToken1: Number(result.volumeToken1),\n        volumeUSD: Number(result.volumeUSD),\n        untrackedVolumeUSD: Number(result.untrackedVolumeUSD),\n        txCount: Number(result.txCount),\n        timestamp: result.timestamp\n      };\n    });\n  },\n  propertiesDayData: ['id', 'date', 'volumeUSD', 'volumeToken0', 'volumeToken1', 'reserveUSD', 'txCount'],\n  callbackDayData: function callbackDayData(results) {\n    return results.map(function (result) {\n      return {\n        id: result.id,\n        date: new Date(result.date * 1000),\n        timestamp: Number(result.date),\n        volumeUSD: Number(result.volumeUSD),\n        volumeToken0: Number(result.volumeToken0),\n        volumeToken1: Number(result.volumeToken1),\n        liquidityUSD: Number(result.reserveUSD),\n        txCount: Number(result.txCount)\n      };\n    });\n  }\n};","map":null,"metadata":{},"sourceType":"script"}