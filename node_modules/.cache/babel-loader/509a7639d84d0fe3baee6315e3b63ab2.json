{"ast":null,"code":"\"use strict\";\n\nvar _toConsumableArray = require(\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/toConsumableArray\");\n\nvar _classCallCheck = require(\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nvar _regeneratorRuntime = require(\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\");\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar rpc_utils_1 = require(\"rpc-utils\");\n\nvar methods = {\n  '3id_getLink': function id_getLink(ctx) {\n    return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return ctx.provider.wallet.getLink();\n\n            case 2:\n              return _context.abrupt(\"return\", _context.sent.toLowerCase());\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n  },\n  '3id_linkManagementKey': function id_linkManagementKey(ctx) {\n    return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return ctx.provider.wallet.linkManagementKey();\n\n            case 2:\n              return _context2.abrupt(\"return\", _context2.sent);\n\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n  },\n  '3id_authenticate': function id_authenticate(ctx, params) {\n    return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return ctx.provider.wallet.authenticate(params.spaces, {\n                authData: params.authData,\n                address: params.address,\n                mgmtPub: params.mgmtPub\n              }, ctx.origin);\n\n            case 2:\n              return _context3.abrupt(\"return\", _context3.sent);\n\n            case 3:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n  },\n  '3id_isAuthenticated': function id_isAuthenticated(ctx, params) {\n    return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return ctx.provider.wallet.isAuthenticated(params.spaces, ctx.origin);\n\n            case 2:\n              return _context4.abrupt(\"return\", _context4.sent);\n\n            case 3:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n  },\n  '3id_signClaim': function id_signClaim(ctx, params) {\n    return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.next = 2;\n              return ctx.provider.wallet.signClaim(params.payload, {\n                DID: params.did,\n                space: params.space,\n                expiresIn: params.expiresIn,\n                useMgmt: params.useMgmt\n              });\n\n            case 2:\n              return _context5.abrupt(\"return\", _context5.sent);\n\n            case 3:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n  },\n  '3id_encrypt': function id_encrypt(ctx, params) {\n    return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              _context6.next = 2;\n              return ctx.provider.wallet.encrypt(params.message, params.space, {\n                blockSize: params.blockSize,\n                to: params.to\n              });\n\n            case 2:\n              return _context6.abrupt(\"return\", _context6.sent);\n\n            case 3:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n  },\n  '3id_decrypt': function id_decrypt(ctx, params) {\n    return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee7() {\n      return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              _context7.next = 2;\n              return ctx.provider.wallet.decrypt({\n                ciphertext: params.ciphertext,\n                ephemeralFrom: params.ephemeralFrom,\n                nonce: params.nonce\n              }, params.space, params.buffer);\n\n            case 2:\n              return _context7.abrupt(\"return\", _context7.sent);\n\n            case 3:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee7);\n    }));\n  },\n  '3id_hashEntryKey': function id_hashEntryKey(ctx, params) {\n    return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee8() {\n      return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              _context8.next = 2;\n              return ctx.provider.wallet.hashDBKey(params.key, params.space);\n\n            case 2:\n              return _context8.abrupt(\"return\", _context8.sent);\n\n            case 3:\n            case \"end\":\n              return _context8.stop();\n          }\n        }\n      }, _callee8);\n    }));\n  },\n  '3id_newAuthMethodPoll': function id_newAuthMethodPoll(ctx) {\n    return ctx.provider.pollAuthMethods();\n  },\n  '3id_newLinkPoll': function id_newLinkPoll(ctx) {\n    return ctx.provider.pollLinks();\n  }\n};\n\nvar ThreeIdProvider = /*#__PURE__*/function () {\n  function ThreeIdProvider(wallet) {\n    var _this = this;\n\n    _classCallCheck(this, ThreeIdProvider);\n\n    this._newAuthMethods = [];\n    this._newLinks = [];\n    this._handle = rpc_utils_1.createHandler(methods);\n    this.wallet = wallet;\n    wallet.events.on('new-auth-method', function (authBlob) {\n      _this._newAuthMethods.push(authBlob);\n    });\n    wallet.events.on('new-link-proof', function (linkProof) {\n      _this._newLinks.push(linkProof);\n    });\n  }\n\n  _createClass(ThreeIdProvider, [{\n    key: \"is3idProvider\",\n    get: function get() {\n      return true;\n    }\n  }, {\n    key: \"pollAuthMethods\",\n    value: function pollAuthMethods() {\n      var methods = _toConsumableArray(this._newAuthMethods);\n\n      this._newAuthMethods = [];\n      return methods;\n    }\n  }, {\n    key: \"pollLinks\",\n    value: function pollLinks() {\n      var links = _toConsumableArray(this._newLinks);\n\n      this._newLinks = [];\n      return links;\n    }\n  }, {\n    key: \"send\",\n    value: function send(req, origin, callback) {\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee9() {\n        var res, error;\n        return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                if (typeof origin === 'function') {\n                  callback = origin;\n                  origin = null;\n                }\n\n                _context9.next = 3;\n                return this._handle({\n                  provider: this,\n                  origin: origin\n                }, req);\n\n              case 3:\n                res = _context9.sent;\n\n                if (!(res === null || res === void 0 ? void 0 : res.error)) {\n                  _context9.next = 12;\n                  break;\n                }\n\n                error = rpc_utils_1.RPCError.fromObject(res.error);\n\n                if (!(callback == null)) {\n                  _context9.next = 10;\n                  break;\n                }\n\n                throw error;\n\n              case 10:\n                callback(error);\n                return _context9.abrupt(\"return\", null);\n\n              case 12:\n                callback === null || callback === void 0 ? void 0 : callback(null, res);\n                return _context9.abrupt(\"return\", res);\n\n              case 14:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9, this);\n      }));\n    }\n  }]);\n\n  return ThreeIdProvider;\n}();\n\nexports.default = ThreeIdProvider;","map":null,"metadata":{},"sourceType":"script"}