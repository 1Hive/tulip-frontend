{"ast":null,"code":"const {\n  rpcEndpoints,\n  ERC20Abi\n} = require('./constants.js');\n\nconst {\n  toBN,\n  fromWei\n} = require('web3-utils');\n\nconst Web3 = require('web3');\n\nconst web3 = new Web3(new Web3.providers.HttpProvider(rpcEndpoints.xdai));\nweb3.eth.net.isListening().then(() => console.log('tulip-data is connected')).catch(e => console.log('Wow. Something went wrong: ' + e));\n\nconst generateContractFunctionList = ({\n  tokens,\n  blockNumber,\n  user_address\n}) => {\n  const batch = new web3.BatchRequest();\n  tokens.map(async ({\n    address: tokenAddress,\n    symbol,\n    decimals\n  }) => {\n    const contract = new web3.eth.Contract(ERC20Abi);\n    contract.options.address = tokenAddress;\n    batch.add(contract.methods.balanceOf(user_address).call.request({}, blockNumber));\n  });\n  return batch;\n};\n\nconst convertToNumber = (hex, decimals) => {\n  const balance = toBN(hex);\n  return fromWei(balance);\n};\n\nmodule.exports = {\n  generateContractFunctionList,\n  convertToNumber\n};","map":null,"metadata":{},"sourceType":"script"}