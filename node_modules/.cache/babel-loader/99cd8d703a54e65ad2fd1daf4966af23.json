{"ast":null,"code":"/* eslint-disable require-await */\n'use strict';\n\nconst {\n  Buffer\n} = require('buffer');\n\nconst multihash = require('multihashes');\n\nconst crypto = self.crypto || self.msCrypto;\n\nconst digest = async (data, alg) => {\n  if (typeof self === 'undefined' || !self.crypto && !self.msCrypto) {\n    throw new Error('Please use a browser with webcrypto support and ensure the code has been delivered securely via HTTPS/TLS and run within a Secure Context');\n  }\n\n  switch (alg) {\n    case 'sha1':\n      return Buffer.from(await crypto.subtle.digest({\n        name: 'SHA-1'\n      }, data));\n\n    case 'sha2-256':\n      return Buffer.from(await crypto.subtle.digest({\n        name: 'SHA-256'\n      }, data));\n\n    case 'sha2-512':\n      return Buffer.from(await crypto.subtle.digest({\n        name: 'SHA-512'\n      }, data));\n\n    case 'dbl-sha2-256':\n      {\n        const d = await crypto.subtle.digest({\n          name: 'SHA-256'\n        }, data);\n        return Buffer.from(await crypto.subtle.digest({\n          name: 'SHA-256'\n        }, d));\n      }\n\n    default:\n      throw new Error(`${alg} is not a supported algorithm`);\n  }\n};\n\nmodule.exports = {\n  factory: alg => async data => {\n    return digest(data, alg);\n  },\n  digest,\n  multihashing: async (buf, alg, length) => {\n    const h = await digest(buf, alg, length);\n    return multihash.encode(h, alg, length);\n  }\n};","map":null,"metadata":{},"sourceType":"script"}