{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar slicedToArray = require('./slicedToArray-a8a77f0e.js');\n\nrequire('./unsupportedIterableToArray-f175acfa.js');\n\nvar React = require('react');\n\nrequire('./_commonjsHelpers-1b94f6bc.js');\n\nvar index = require('./index-46d0e707.js');\n\nvar defineProperty = require('./defineProperty-3cad0327.js');\n\nrequire('./toConsumableArray-cc0d28a9.js');\n\nvar _styled = require('styled-components');\n\nrequire('./getPrototypeOf-55c9e80c.js');\n\nrequire('./color.js');\n\nrequire('./css.js');\n\nrequire('./miscellaneous.js');\n\nrequire('./environment.js');\n\nrequire('./font.js');\n\nrequire('./keycodes.js');\n\nvar constants = require('./constants.js');\n\nrequire('./breakpoints.js');\n\nvar springs = require('./springs.js');\n\nvar textStyles = require('./text-styles.js');\n\nrequire('./theme-dark.js');\n\nrequire('./theme-light.js');\n\nvar Theme = require('./Theme.js');\n\nrequire('./extends-023d783e.js');\n\nrequire('./objectWithoutProperties-c6d3675c.js');\n\nrequire('./index-4def0554.js');\n\nrequire('./_baseGetTag-42b4dd3e.js');\n\nrequire('./Viewport-819c53c9.js');\n\nvar Layout = require('./Layout.js');\n\nrequire('./FocusVisible.js');\n\nrequire('./ButtonBase.js');\n\nrequire('./IconPropTypes-12cd7567.js');\n\nrequire('./IconDown.js');\n\nrequire('./IconUp.js');\n\nrequire('./objectWithoutPropertiesLoose-1af20ad0.js');\n\nrequire('react-dom');\n\nvar web = require('./web-7cbdbd84.js');\n\nvar Checkbox = require('./Checkbox.js');\n\nrequire('./Button.js');\n\nrequire('./ButtonIcon.js');\n\nvar ToggleButton = require('./ToggleButton.js');\n\nvar OpenedSurfaceBorder = require('./OpenedSurfaceBorder.js');\n\nfunction _interopDefaultLegacy(e) {\n  return e && typeof e === 'object' && 'default' in e ? e : {\n    'default': e\n  };\n}\n\nvar React__default = /*#__PURE__*/_interopDefaultLegacy(React);\n\nvar _styled__default = /*#__PURE__*/_interopDefaultLegacy(_styled);\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        defineProperty.defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction headingsFromFields(fields, _ref) {\n  var hasAnyActions = _ref.hasAnyActions,\n      hasAnyExpansion = _ref.hasAnyExpansion,\n      selectContent = _ref.selectContent,\n      selectable = _ref.selectable;\n  var cells = fields.map(function (field, index) {\n    return [field.label, field.align === 'end' ? 'right' : 'left'];\n  });\n\n  if (hasAnyExpansion || selectable) {\n    cells.unshift([selectable ? selectContent : null, 'left']);\n  }\n\n  if (hasAnyActions) {\n    cells.push([null, 'left']);\n  } // Return null if all the fields are empty\n\n\n  if (cells.every(function (cell) {\n    return !cell[0];\n  })) {\n    return null;\n  }\n\n  return cells;\n}\n\nfunction cellsFromEntry(entry, _ref2) {\n  var fields = _ref2.fields,\n      hasAnyActions = _ref2.hasAnyActions,\n      hasAnyExpansion = _ref2.hasAnyExpansion,\n      hasExpansion = _ref2.hasExpansion,\n      selectContent = _ref2.selectContent,\n      selectable = _ref2.selectable,\n      toggleChildContent = _ref2.toggleChildContent;\n  var cells = entry.entryNodes.map(function (content, index) {\n    return [content, fields[index].align, false];\n  }); // Checkbox\n\n  if (selectable) {\n    cells.unshift([selectContent, 'start', true]);\n  } // Toggle child\n\n\n  if (!selectable && hasAnyExpansion) {\n    cells.unshift([hasExpansion && toggleChildContent, 'start', true]);\n  } // Actions\n\n\n  if (hasAnyActions) {\n    cells.push([entry.actions, 'end', true]);\n  }\n\n  return cells;\n}\n\nvar _StyledTable = _styled__default['default'](\"table\").withConfig({\n  displayName: \"TableView___StyledTable\",\n  componentId: \"aczwu3-0\"\n})([\"width:100%;border-spacing:0;border-collapse:separate;\"]);\n\nfunction TableView(_ref3) {\n  var alignChildOnField = _ref3.alignChildOnField,\n      allSelected = _ref3.allSelected,\n      entries = _ref3.entries,\n      fields = _ref3.fields,\n      hasAnyActions = _ref3.hasAnyActions,\n      hasAnyExpansion = _ref3.hasAnyExpansion,\n      onSelect = _ref3.onSelect,\n      onSelectAll = _ref3.onSelectAll,\n      renderSelectionCount = _ref3.renderSelectionCount,\n      rowHeight = _ref3.rowHeight,\n      selectable = _ref3.selectable,\n      selectedCount = _ref3.selectedCount;\n\n  var _useState = React.useState(-1),\n      _useState2 = slicedToArray.slicedToArray(_useState, 2),\n      opened = _useState2[0],\n      setOpened = _useState2[1];\n\n  var toggleEntry = React.useCallback(function (index) {\n    setOpened(function (opened) {\n      return opened === index ? -1 : index;\n    });\n  }, []);\n  var headCells = React.useMemo(function () {\n    return headingsFromFields(fields, {\n      hasAnyActions: hasAnyActions,\n      hasAnyExpansion: hasAnyExpansion,\n      selectContent: /*#__PURE__*/React__default['default'].createElement(Checkbox.default, {\n        indeterminate: allSelected === 0,\n        checked: allSelected > -1,\n        onChange: onSelectAll\n      }),\n      selectable: selectable\n    });\n  }, [fields, hasAnyActions, hasAnyExpansion, allSelected, onSelectAll, selectable]);\n  React.useEffect(function () {\n    setOpened(-1);\n  }, [entries, fields]);\n  return /*#__PURE__*/React__default['default'].createElement(_StyledTable, null, headCells && /*#__PURE__*/React__default['default'].createElement(\"thead\", null, /*#__PURE__*/React__default['default'].createElement(HeadRow, {\n    cells: headCells,\n    selectedCount: selectedCount,\n    renderSelectionCount: renderSelectionCount\n  })), /*#__PURE__*/React__default['default'].createElement(\"tbody\", null, entries.map(function (entry, index) {\n    return /*#__PURE__*/React__default['default'].createElement(Entry, {\n      key: entry.index,\n      alignChildOnField: alignChildOnField,\n      entry: entry,\n      fields: fields,\n      firstRow: index === 0,\n      hasAnyActions: hasAnyActions,\n      hasAnyExpansion: hasAnyExpansion,\n      onSelect: onSelect,\n      onToggle: toggleEntry,\n      opened: opened === entry.index,\n      rowHeight: rowHeight,\n      selectable: selectable\n    });\n  })));\n}\n\nTableView.propTypes = {\n  alignChildOnField: index.propTypes.number.isRequired,\n  allSelected: index.propTypes.oneOf([-1, 0, 1]).isRequired,\n  entries: index.propTypes.array.isRequired,\n  fields: index.propTypes.array.isRequired,\n  hasAnyActions: index.propTypes.bool.isRequired,\n  hasAnyExpansion: index.propTypes.bool.isRequired,\n  onSelect: index.propTypes.func.isRequired,\n  onSelectAll: index.propTypes.func.isRequired,\n  renderSelectionCount: index.propTypes.func.isRequired,\n  rowHeight: index.propTypes.number.isRequired,\n  selectable: index.propTypes.bool.isRequired,\n  selectedCount: index.propTypes.number.isRequired\n}; // Disable prop types check for internal components\n\n/* eslint-disable react/prop-types */\n\nfunction useSidePadding() {\n  var _useLayout = Layout.useLayout(),\n      layoutName = _useLayout.layoutName;\n\n  return layoutName === 'small' ? 2 * constants.GU : 3 * constants.GU;\n}\n\nvar _StyledTh = _styled__default['default'](\"th\").withConfig({\n  displayName: \"TableView___StyledTh\",\n  componentId: \"aczwu3-1\"\n})([\"height:\", \"px;padding:0;padding-left:\", \"px;padding-right:\", \"px;text-align:\", \";\", \";color:\", \";border-bottom:1px solid \", \";\"], function (p) {\n  return p._css;\n}, function (p) {\n  return p._css2;\n}, function (p) {\n  return p._css3;\n}, function (p) {\n  return p._css4;\n}, function (p) {\n  return p._css5;\n}, function (p) {\n  return p._css6;\n}, function (p) {\n  return p._css7;\n});\n\nfunction HeadRow(_ref4) {\n  var cells = _ref4.cells,\n      selectedCount = _ref4.selectedCount,\n      renderSelectionCount = _ref4.renderSelectionCount;\n  var theme = Theme.useTheme();\n  var sidePadding = useSidePadding();\n  return /*#__PURE__*/React__default['default'].createElement(\"tr\", null, cells.map(function (cell, index) {\n    var hidden = selectedCount > 0 && index > 1;\n    var content = selectedCount > 0 && index === 1 ? renderSelectionCount(selectedCount) : cell[0];\n    return !hidden && /*#__PURE__*/React__default['default'].createElement(_StyledTh, {\n      key: index,\n      colSpan: selectedCount > 0 && index === 1 ? cells.length - 1 : 1,\n      _css: 4 * constants.GU,\n      _css2: index === 0 ? sidePadding : 0,\n      _css3: index === cells.length - 1 ? sidePadding : 0,\n      _css4: cell[1],\n      _css5: textStyles.textStyle('label2'),\n      _css6: theme.surfaceContentSecondary,\n      _css7: theme.border\n    }, content);\n  }));\n}\n\nvar Entry = /*#__PURE__*/React__default['default'].memo(function Entry(_ref5) {\n  var alignChildOnField = _ref5.alignChildOnField,\n      entry = _ref5.entry,\n      fields = _ref5.fields,\n      firstRow = _ref5.firstRow,\n      hasAnyActions = _ref5.hasAnyActions,\n      hasAnyExpansion = _ref5.hasAnyExpansion,\n      onSelect = _ref5.onSelect,\n      onToggle = _ref5.onToggle,\n      opened = _ref5.opened,\n      rowHeight = _ref5.rowHeight,\n      selectable = _ref5.selectable;\n  var hasExpansion = entry.expansion.content.length > 0;\n  var entryIndex = entry.index;\n  var handleToggle = React.useCallback(function () {\n    onToggle(entryIndex);\n  }, [entryIndex, onToggle]);\n  var handleSelectChange = React.useCallback(function (check) {\n    onSelect(entryIndex, check);\n  }, [entryIndex, onSelect]);\n  var cells = cellsFromEntry(entry, {\n    fields: fields,\n    hasAnyActions: hasAnyActions,\n    hasAnyExpansion: hasAnyExpansion,\n    hasExpansion: hasExpansion,\n    selectable: selectable,\n    toggleChildContent: hasAnyExpansion ? /*#__PURE__*/React__default['default'].createElement(Toggle, {\n      opened: opened,\n      onToggle: handleToggle\n    }) : null,\n    selectContent: selectable ? /*#__PURE__*/React__default['default'].createElement(Checkbox.default, {\n      onChange: handleSelectChange,\n      checked: entry.selected\n    }) : null\n  });\n  return /*#__PURE__*/React__default['default'].createElement(React__default['default'].Fragment, null, /*#__PURE__*/React__default['default'].createElement(EntryRow, {\n    cells: cells,\n    firstRow: firstRow,\n    rowHeight: rowHeight,\n    selected: entry.selected\n  }), hasExpansion && /*#__PURE__*/React__default['default'].createElement(EntryExpansion, {\n    alignChildOnCell: alignChildOnField + 1,\n    cellsCount: cells.length,\n    expansion: entry.expansion,\n    opened: opened,\n    rowHeight: rowHeight\n  }));\n});\n\nvar _StyledTr = _styled__default['default'](\"tr\").withConfig({\n  displayName: \"TableView___StyledTr\",\n  componentId: \"aczwu3-2\"\n})([\"transition:background 150ms ease-in-out;background:\", \";\"], function (p) {\n  return p._css8;\n});\n\nvar _StyledTd = _styled__default['default'](\"td\").withConfig({\n  displayName: \"TableView___StyledTd\",\n  componentId: \"aczwu3-3\"\n})([\"position:relative;width:\", \";height:\", \"px;padding-top:0;padding-bottom:0;padding-left:\", \"px;padding-right:\", \"px;border-top:\", \";\"], function (p) {\n  return p._css9;\n}, function (p) {\n  return p._css10;\n}, function (p) {\n  return p._css11;\n}, function (p) {\n  return p._css12;\n}, function (p) {\n  return p._css13;\n});\n\nvar _StyledDiv = _styled__default['default'](\"div\").withConfig({\n  displayName: \"TableView___StyledDiv\",\n  componentId: \"aczwu3-4\"\n})([\"display:flex;width:100%;justify-content:\", \";\"], function (p) {\n  return p._css14;\n});\n\nfunction EntryRow(_ref6) {\n  var firstRow = _ref6.firstRow,\n      cells = _ref6.cells,\n      selected = _ref6.selected,\n      rowHeight = _ref6.rowHeight,\n      mode = _ref6.mode;\n  var theme = Theme.useTheme();\n  var sidePadding = useSidePadding();\n  return /*#__PURE__*/React__default['default'].createElement(_StyledTr, {\n    _css8: selected ? theme.surfaceSelected : 'none'\n  }, cells.map(function (_ref7, index, cells) {\n    var _ref8 = slicedToArray.slicedToArray(_ref7, 3),\n        content = _ref8[0],\n        align = _ref8[1],\n        compact = _ref8[2];\n\n    var first = index === 0;\n    var last = index === cells.length - 1;\n    return /*#__PURE__*/React__default['default'].createElement(_StyledTd, {\n      key: index,\n      _css9: compact ? '1px' // For some reason Blink tends to make 0 grow but not 1px\n      : 'auto',\n      _css10: rowHeight,\n      _css11: first || compact ? sidePadding : 0,\n      _css12: !first && (align !== 'end' || last) || compact ? sidePadding : 0,\n      _css13: firstRow ? '0' : \"1px solid \".concat(theme.border)\n    }, /*#__PURE__*/React__default['default'].createElement(_StyledDiv, {\n      _css14: \"flex-\".concat(align)\n    }, content));\n  }));\n}\n\nvar _StyledTr2 = _styled__default['default'](\"tr\").withConfig({\n  displayName: \"TableView___StyledTr2\",\n  componentId: \"aczwu3-5\"\n})([\"td{position:relative;padding:0;box-shadow:inset 0 6px 4px -4px rgba(0,0,0,0.16);background:\", \";}\"], function (p) {\n  return p._css15;\n});\n\nvar _StyledAnimatedDiv = _styled__default['default'](web.extendedAnimated.div).withConfig({\n  displayName: \"TableView___StyledAnimatedDiv\",\n  componentId: \"aczwu3-6\"\n})([\"overflow:hidden\"]);\n\nvar _StyledDiv2 = _styled__default['default'](\"div\").withConfig({\n  displayName: \"TableView___StyledDiv2\",\n  componentId: \"aczwu3-7\"\n})([\"height:\", \";border-top:1px solid \", \";\"], function (p) {\n  return p._css16;\n}, function (p) {\n  return p._css17;\n});\n\nvar _StyledAnimatedDiv2 = _styled__default['default'](web.extendedAnimated.div).withConfig({\n  displayName: \"TableView___StyledAnimatedDiv2\",\n  componentId: \"aczwu3-8\"\n})([\"overflow:hidden\"]);\n\nvar _StyledDiv3 = _styled__default['default'](\"div\").withConfig({\n  displayName: \"TableView___StyledDiv3\",\n  componentId: \"aczwu3-9\"\n})([\"display:flex;align-items:center;height:\", \";padding-left:\", \"px;padding-right:\", \"px;border-top:1px solid \", \";\"], function (p) {\n  return p._css18;\n}, function (p) {\n  return p._css19;\n}, function (p) {\n  return p._css20;\n}, function (p) {\n  return p._css21;\n});\n\nfunction EntryExpansion(_ref9) {\n  var alignChildOnCell = _ref9.alignChildOnCell,\n      cellsCount = _ref9.cellsCount,\n      expansion = _ref9.expansion,\n      opened = _ref9.opened,\n      rowHeight = _ref9.rowHeight;\n  var theme = Theme.useTheme(); // Handles the height of the expansion in free layout mode\n\n  var _useState3 = React.useState(0),\n      _useState4 = slicedToArray.slicedToArray(_useState3, 2),\n      freeLayoutContentHeight = _useState4[0],\n      setFreeLayoutContentHeight = _useState4[1];\n\n  var handleFreeLayoutContentRef = React.useCallback(function (element) {\n    if (element) {\n      setFreeLayoutContentHeight(element.getBoundingClientRect().height);\n    }\n  }, []);\n  var height = expansion.freeLayout ? freeLayoutContentHeight : rowHeight * expansion.content.length;\n  return /*#__PURE__*/React__default['default'].createElement(web.Transition, {\n    native: true,\n    unique: true,\n    items: opened,\n    from: {\n      height: 0\n    },\n    enter: {\n      height: height\n    },\n    update: {\n      height: height\n    },\n    leave: {\n      height: 0\n    },\n    config: _objectSpread(_objectSpread({}, springs.springs.smooth), {}, {\n      precision: 0.1\n    })\n  }, function (show) {\n    return show && function (_ref10) {\n      var height = _ref10.height;\n      return /*#__PURE__*/React__default['default'].createElement(_StyledTr2, {\n        _css15: theme.surfaceUnder\n      }, alignChildOnCell > 0 && /*#__PURE__*/React__default['default'].createElement(\"td\", {\n        colSpan: alignChildOnCell\n      }, /*#__PURE__*/React__default['default'].createElement(OpenedSurfaceBorder.OpenedSurfaceBorder, {\n        opened: opened\n      }), /*#__PURE__*/React__default['default'].createElement(_StyledAnimatedDiv, {\n        style: {\n          height: height\n        }\n      }, expansion.content.map(function (child, i) {\n        return /*#__PURE__*/React__default['default'].createElement(_StyledDiv2, {\n          key: i,\n          _css16: expansion.freeLayout ? 'auto' : \"\".concat(rowHeight, \"px\"),\n          _css17: theme.border\n        });\n      }))), /*#__PURE__*/React__default['default'].createElement(\"td\", {\n        colSpan: alignChildOnCell === -1 ? cellsCount : cellsCount - alignChildOnCell\n      }, alignChildOnCell === 0 && /*#__PURE__*/React__default['default'].createElement(OpenedSurfaceBorder.OpenedSurfaceBorder, {\n        opened: opened\n      }), /*#__PURE__*/React__default['default'].createElement(_StyledAnimatedDiv2, {\n        style: {\n          height: height\n        }\n      }, expansion.content.map(function (child, i) {\n        return /*#__PURE__*/React__default['default'].createElement(_StyledDiv3, {\n          key: i,\n          ref: expansion.freeLayout ? handleFreeLayoutContentRef : null,\n          _css18: expansion.freeLayout ? 'auto' : \"\".concat(rowHeight, \"px\"),\n          _css19: alignChildOnCell < 1 ? 3 * constants.GU : 0,\n          _css20: 3 * constants.GU,\n          _css21: theme.border\n        }, child);\n      }))));\n    };\n  });\n}\n\nvar _StyledDiv4 = _styled__default['default'](\"div\").withConfig({\n  displayName: \"TableView___StyledDiv4\",\n  componentId: \"aczwu3-10\"\n})([\"width:100%;height:100%;\"]);\n\nvar Toggle = /*#__PURE__*/React__default['default'].memo(function Toggle(_ref11) {\n  var opened = _ref11.opened,\n      onToggle = _ref11.onToggle;\n  return /*#__PURE__*/React__default['default'].createElement(_StyledDiv4, null, /*#__PURE__*/React__default['default'].createElement(OpenedSurfaceBorder.OpenedSurfaceBorder, {\n    opened: opened\n  }), /*#__PURE__*/React__default['default'].createElement(ToggleButton.ToggleButton, {\n    opened: opened,\n    onClick: onToggle\n  }));\n});\nexports.TableView = TableView;","map":{"version":3,"sources":["../src/components/DataView/TableView.js"],"names":["hasAnyActions","hasAnyExpansion","selectContent","selectable","cells","field","cell","fields","hasExpansion","toggleChildContent","entry","alignChildOnField","allSelected","entries","onSelect","onSelectAll","renderSelectionCount","rowHeight","selectedCount","opened","setOpened","useState","toggleEntry","useCallback","headCells","useMemo","headingsFromFields","Checkbox","useEffect","index","TableView","PropTypes","isRequired","layoutName","useLayout","GU","theme","useTheme","sidePadding","useSidePadding","hidden","content","textStyle","border","Entry","firstRow","onToggle","entryIndex","handleToggle","handleSelectChange","cellsFromEntry","selected","React","mode","align","compact","first","last","alignChildOnCell","cellsCount","expansion","freeLayoutContentHeight","setFreeLayoutContentHeight","handleFreeLayoutContentRef","element","height","Transition","springs","precision","show","surfaceUnder","OpenedSurfaceBorder","Toggle","ToggleButton"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useMemo, useState } from 'react'\nimport PropTypes from 'prop-types'\nimport { Transition, animated } from 'react-spring'\nimport { GU, springs, textStyle } from '../../style'\nimport { useTheme } from '../../theme'\nimport { useLayout } from '../Layout/Layout'\nimport Checkbox from '../Input/Checkbox'\nimport { ToggleButton } from './ToggleButton'\nimport { OpenedSurfaceBorder } from './OpenedSurfaceBorder'\n\n// Table heading cells\nfunction headingsFromFields(\n  fields,\n  { hasAnyActions, hasAnyExpansion, selectContent, selectable }\n) {\n  const cells = fields.map((field, index) => [\n    field.label,\n    field.align === 'end' ? 'right' : 'left',\n  ])\n\n  if (hasAnyExpansion || selectable) {\n    cells.unshift([selectable ? selectContent : null, 'left'])\n  }\n\n  if (hasAnyActions) {\n    cells.push([null, 'left'])\n  }\n\n  // Return null if all the fields are empty\n  if (cells.every(cell => !cell[0])) {\n    return null\n  }\n\n  return cells\n}\n\nfunction cellsFromEntry(\n  entry,\n  {\n    fields,\n    hasAnyActions,\n    hasAnyExpansion,\n    hasExpansion,\n    selectContent,\n    selectable,\n    toggleChildContent,\n  }\n) {\n  const cells = entry.entryNodes.map((content, index) => [\n    content,\n    fields[index].align,\n    false,\n  ])\n\n  // Checkbox\n  if (selectable) {\n    cells.unshift([selectContent, 'start', true])\n  }\n\n  // Toggle child\n  if (!selectable && hasAnyExpansion) {\n    cells.unshift([hasExpansion && toggleChildContent, 'start', true])\n  }\n\n  // Actions\n  if (hasAnyActions) {\n    cells.push([entry.actions, 'end', true])\n  }\n\n  return cells\n}\n\nfunction TableView({\n  alignChildOnField,\n  allSelected,\n  entries,\n  fields,\n  hasAnyActions,\n  hasAnyExpansion,\n  onSelect,\n  onSelectAll,\n  renderSelectionCount,\n  rowHeight,\n  selectable,\n  selectedCount,\n}) {\n  const [opened, setOpened] = useState(-1)\n\n  const toggleEntry = useCallback(index => {\n    setOpened(opened => (opened === index ? -1 : index))\n  }, [])\n\n  const headCells = useMemo(\n    () =>\n      headingsFromFields(fields, {\n        hasAnyActions,\n        hasAnyExpansion,\n        selectContent: (\n          <Checkbox\n            indeterminate={allSelected === 0}\n            checked={allSelected > -1}\n            onChange={onSelectAll}\n          />\n        ),\n        selectable,\n      }),\n    [\n      fields,\n      hasAnyActions,\n      hasAnyExpansion,\n      allSelected,\n      onSelectAll,\n      selectable,\n    ]\n  )\n\n  useEffect(() => {\n    setOpened(-1)\n  }, [entries, fields])\n\n  return (\n    <table\n      css={`\n        width: 100%;\n        border-spacing: 0;\n        border-collapse: separate;\n      `}\n    >\n      {headCells && (\n        <thead>\n          <HeadRow\n            cells={headCells}\n            selectedCount={selectedCount}\n            renderSelectionCount={renderSelectionCount}\n          />\n        </thead>\n      )}\n      <tbody>\n        {entries.map((entry, index) => (\n          <Entry\n            key={entry.index}\n            alignChildOnField={alignChildOnField}\n            entry={entry}\n            fields={fields}\n            firstRow={index === 0}\n            hasAnyActions={hasAnyActions}\n            hasAnyExpansion={hasAnyExpansion}\n            onSelect={onSelect}\n            onToggle={toggleEntry}\n            opened={opened === entry.index}\n            rowHeight={rowHeight}\n            selectable={selectable}\n          />\n        ))}\n      </tbody>\n    </table>\n  )\n}\n\nTableView.propTypes = {\n  alignChildOnField: PropTypes.number.isRequired,\n  allSelected: PropTypes.oneOf([-1, 0, 1]).isRequired,\n  entries: PropTypes.array.isRequired,\n  fields: PropTypes.array.isRequired,\n  hasAnyActions: PropTypes.bool.isRequired,\n  hasAnyExpansion: PropTypes.bool.isRequired,\n  onSelect: PropTypes.func.isRequired,\n  onSelectAll: PropTypes.func.isRequired,\n  renderSelectionCount: PropTypes.func.isRequired,\n  rowHeight: PropTypes.number.isRequired,\n  selectable: PropTypes.bool.isRequired,\n  selectedCount: PropTypes.number.isRequired,\n}\n\n// Disable prop types check for internal components\n/* eslint-disable react/prop-types */\n\nfunction useSidePadding() {\n  const { layoutName } = useLayout()\n  return layoutName === 'small' ? 2 * GU : 3 * GU\n}\n\nfunction HeadRow({ cells, selectedCount, renderSelectionCount }) {\n  const theme = useTheme()\n  const sidePadding = useSidePadding()\n  return (\n    <tr>\n      {cells.map((cell, index) => {\n        const hidden = selectedCount > 0 && index > 1\n        const content =\n          selectedCount > 0 && index === 1\n            ? renderSelectionCount(selectedCount)\n            : cell[0]\n        return (\n          !hidden && (\n            <th\n              key={index}\n              css={`\n                height: ${4 * GU}px;\n                padding: 0;\n                padding-left: ${index === 0 ? sidePadding : 0}px;\n                padding-right: ${index === cells.length - 1\n                  ? sidePadding\n                  : 0}px;\n                text-align: ${cell[1]};\n                ${textStyle('label2')};\n                color: ${theme.surfaceContentSecondary};\n                border-bottom: 1px solid ${theme.border};\n              `}\n              colSpan={selectedCount > 0 && index === 1 ? cells.length - 1 : 1}\n            >\n              {content}\n            </th>\n          )\n        )\n      })}\n    </tr>\n  )\n}\n\nconst Entry = React.memo(function Entry({\n  alignChildOnField,\n  entry,\n  fields,\n  firstRow,\n  hasAnyActions,\n  hasAnyExpansion,\n  onSelect,\n  onToggle,\n  opened,\n  rowHeight,\n  selectable,\n}) {\n  const hasExpansion = entry.expansion.content.length > 0\n  const entryIndex = entry.index\n\n  const handleToggle = useCallback(() => {\n    onToggle(entryIndex)\n  }, [entryIndex, onToggle])\n\n  const handleSelectChange = useCallback(\n    check => {\n      onSelect(entryIndex, check)\n    },\n    [entryIndex, onSelect]\n  )\n\n  const cells = cellsFromEntry(entry, {\n    fields,\n    hasAnyActions,\n    hasAnyExpansion,\n    hasExpansion,\n    selectable,\n    toggleChildContent: hasAnyExpansion ? (\n      <Toggle opened={opened} onToggle={handleToggle} />\n    ) : null,\n    selectContent: selectable ? (\n      <Checkbox onChange={handleSelectChange} checked={entry.selected} />\n    ) : null,\n  })\n\n  return (\n    <React.Fragment>\n      <EntryRow\n        cells={cells}\n        firstRow={firstRow}\n        rowHeight={rowHeight}\n        selected={entry.selected}\n      />\n      {hasExpansion && (\n        <EntryExpansion\n          alignChildOnCell={alignChildOnField + 1}\n          cellsCount={cells.length}\n          expansion={entry.expansion}\n          opened={opened}\n          rowHeight={rowHeight}\n        />\n      )}\n    </React.Fragment>\n  )\n})\n\nfunction EntryRow({ firstRow, cells, selected, rowHeight, mode }) {\n  const theme = useTheme()\n  const sidePadding = useSidePadding()\n\n  return (\n    <tr\n      css={`\n        transition: background 150ms ease-in-out;\n        background: ${selected ? theme.surfaceSelected : 'none'};\n      `}\n    >\n      {cells.map(([content, align, compact], index, cells) => {\n        const first = index === 0\n        const last = index === cells.length - 1\n        return (\n          <td\n            key={index}\n            css={`\n              position: relative;\n              width: ${compact\n                ? '1px' // For some reason Blink tends to make 0 grow but not 1px\n                : 'auto'};\n              height: ${rowHeight}px;\n              padding-top: 0;\n              padding-bottom: 0;\n              padding-left: ${first || compact ? sidePadding : 0}px;\n              padding-right: ${(!first && (align !== 'end' || last)) || compact\n                ? sidePadding\n                : 0}px;\n              border-top: ${firstRow ? '0' : `1px solid ${theme.border}`};\n            `}\n          >\n            <div\n              css={`\n                display: flex;\n                width: 100%;\n                justify-content: ${`flex-${align}`};\n              `}\n            >\n              {content}\n            </div>\n          </td>\n        )\n      })}\n    </tr>\n  )\n}\n\nfunction EntryExpansion({\n  alignChildOnCell,\n  cellsCount,\n  expansion,\n  opened,\n  rowHeight,\n}) {\n  const theme = useTheme()\n\n  // Handles the height of the expansion in free layout mode\n  const [freeLayoutContentHeight, setFreeLayoutContentHeight] = useState(0)\n\n  const handleFreeLayoutContentRef = useCallback(element => {\n    if (element) {\n      setFreeLayoutContentHeight(element.getBoundingClientRect().height)\n    }\n  }, [])\n\n  const height = expansion.freeLayout\n    ? freeLayoutContentHeight\n    : rowHeight * expansion.content.length\n\n  return (\n    <Transition\n      native\n      unique\n      items={opened}\n      from={{ height: 0 }}\n      enter={{ height }}\n      update={{ height }}\n      leave={{ height: 0 }}\n      config={{ ...springs.smooth, precision: 0.1 }}\n    >\n      {show =>\n        show &&\n        (({ height }) => (\n          <tr\n            css={`\n              td {\n                position: relative;\n                padding: 0;\n                box-shadow: inset 0 6px 4px -4px rgba(0, 0, 0, 0.16);\n                background: ${theme.surfaceUnder};\n              }\n            `}\n          >\n            {alignChildOnCell > 0 && (\n              <td colSpan={alignChildOnCell}>\n                <OpenedSurfaceBorder opened={opened} />\n                <animated.div css=\"overflow: hidden\" style={{ height }}>\n                  {expansion.content.map((child, i) => (\n                    <div\n                      key={i}\n                      css={`\n                        height: ${expansion.freeLayout\n                          ? 'auto'\n                          : `${rowHeight}px`};\n                        border-top: 1px solid ${theme.border};\n                      `}\n                    />\n                  ))}\n                </animated.div>\n              </td>\n            )}\n            <td\n              colSpan={\n                alignChildOnCell === -1\n                  ? cellsCount\n                  : cellsCount - alignChildOnCell\n              }\n            >\n              {alignChildOnCell === 0 && (\n                <OpenedSurfaceBorder opened={opened} />\n              )}\n              <animated.div css=\"overflow: hidden\" style={{ height }}>\n                {expansion.content.map((child, i) => (\n                  <div\n                    key={i}\n                    ref={\n                      expansion.freeLayout ? handleFreeLayoutContentRef : null\n                    }\n                    css={`\n                      display: flex;\n                      align-items: center;\n                      height: ${expansion.freeLayout\n                        ? 'auto'\n                        : `${rowHeight}px`};\n                      padding-left: ${alignChildOnCell < 1 ? 3 * GU : 0}px;\n                      padding-right: ${3 * GU}px;\n                      border-top: 1px solid ${theme.border};\n                    `}\n                  >\n                    {child}\n                  </div>\n                ))}\n              </animated.div>\n            </td>\n          </tr>\n        ))\n      }\n    </Transition>\n  )\n}\n\nconst Toggle = React.memo(function Toggle({ opened, onToggle }) {\n  return (\n    <div\n      css={`\n        width: 100%;\n        height: 100%;\n      `}\n    >\n      <OpenedSurfaceBorder opened={opened} />\n      <ToggleButton opened={opened} onClick={onToggle} />\n    </div>\n  )\n})\n\n/* eslint-enable react/prop-types */\n\nexport { TableView }\n"]},"metadata":{},"sourceType":"script"}