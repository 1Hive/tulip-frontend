{"ast":null,"code":"'use strict';\n\nrequire('node-forge/lib/ed25519');\n\nconst forge = require('node-forge/lib/forge');\n\nexports.publicKeyLength = forge.pki.ed25519.constants.PUBLIC_KEY_BYTE_LENGTH;\nexports.privateKeyLength = forge.pki.ed25519.constants.PRIVATE_KEY_BYTE_LENGTH;\n\nexports.generateKey = async function () {\n  // eslint-disable-line require-await\n  return forge.pki.ed25519.generateKeyPair();\n}; // seed should be a 32 byte uint8array\n\n\nexports.generateKeyFromSeed = async function (seed) {\n  // eslint-disable-line require-await\n  return forge.pki.ed25519.generateKeyPair({\n    seed\n  });\n};\n\nexports.hashAndSign = async function (key, msg) {\n  // eslint-disable-line require-await\n  return forge.pki.ed25519.sign({\n    message: msg,\n    privateKey: key\n  }); // return Buffer.from(nacl.sign.detached(msg, key))\n};\n\nexports.hashAndVerify = async function (key, sig, msg) {\n  // eslint-disable-line require-await\n  return forge.pki.ed25519.verify({\n    signature: sig,\n    message: msg,\n    publicKey: key\n  });\n};","map":null,"metadata":{},"sourceType":"script"}