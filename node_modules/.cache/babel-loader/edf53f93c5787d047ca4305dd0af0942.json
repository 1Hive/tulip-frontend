{"ast":null,"code":"'use strict';\n\nvar _regeneratorRuntime = require(\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\");\n\nvar _asyncToGenerator = require(\"/Users/fabianmolina/Documents/1hive/tulip-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/asyncToGenerator\");\n\nvar waitForPeers = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(ipfs, peersToWait, topic) {\n    var checkPeers;\n    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            checkPeers = /*#__PURE__*/function () {\n              var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n                var peers, hasAllPeers;\n                return _regeneratorRuntime.wrap(function _callee$(_context) {\n                  while (1) {\n                    switch (_context.prev = _context.next) {\n                      case 0:\n                        _context.next = 2;\n                        return ipfs.pubsub.peers(topic);\n\n                      case 2:\n                        peers = _context.sent;\n                        hasAllPeers = peersToWait.map(function (e) {\n                          return peers.includes(e);\n                        }).filter(function (e) {\n                          return e === false;\n                        }).length === 0;\n                        return _context.abrupt(\"return\", hasAllPeers);\n\n                      case 5:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }\n                }, _callee);\n              }));\n\n              return function checkPeers() {\n                return _ref2.apply(this, arguments);\n              };\n            }();\n\n            _context4.next = 3;\n            return checkPeers();\n\n          case 3:\n            if (!_context4.sent) {\n              _context4.next = 5;\n              break;\n            }\n\n            return _context4.abrupt(\"return\", Promise.resolve());\n\n          case 5:\n            return _context4.abrupt(\"return\", new Promise( /*#__PURE__*/function () {\n              var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(resolve, reject) {\n                var interval;\n                return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                  while (1) {\n                    switch (_context3.prev = _context3.next) {\n                      case 0:\n                        interval = setInterval( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n                          return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                            while (1) {\n                              switch (_context2.prev = _context2.next) {\n                                case 0:\n                                  _context2.prev = 0;\n                                  _context2.next = 3;\n                                  return checkPeers();\n\n                                case 3:\n                                  if (!_context2.sent) {\n                                    _context2.next = 6;\n                                    break;\n                                  }\n\n                                  clearInterval(interval);\n                                  resolve();\n\n                                case 6:\n                                  _context2.next = 11;\n                                  break;\n\n                                case 8:\n                                  _context2.prev = 8;\n                                  _context2.t0 = _context2[\"catch\"](0);\n                                  reject(_context2.t0);\n\n                                case 11:\n                                case \"end\":\n                                  return _context2.stop();\n                              }\n                            }\n                          }, _callee2, null, [[0, 8]]);\n                        })), 100);\n\n                      case 1:\n                      case \"end\":\n                        return _context3.stop();\n                    }\n                  }\n                }, _callee3);\n              }));\n\n              return function (_x4, _x5) {\n                return _ref3.apply(this, arguments);\n              };\n            }()));\n\n          case 6:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  }));\n\n  return function waitForPeers(_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nmodule.exports = waitForPeers;","map":null,"metadata":{},"sourceType":"script"}