{"ast":null,"code":"\"use strict\";\n\nvar nacl = require('tweetnacl');\n\nnacl.util = require('tweetnacl-util');\n\nvar randomNonce = function randomNonce() {\n  return nacl.randomBytes(24);\n};\n\nvar symEncryptBase = function symEncryptBase(msg, symKey, nonce) {\n  nonce = nonce || randomNonce();\n\n  if (typeof msg === 'string') {\n    msg = nacl.util.decodeUTF8(msg);\n  }\n\n  var ciphertext = nacl.secretbox(msg, nonce, symKey);\n  return {\n    nonce: nacl.util.encodeBase64(nonce),\n    ciphertext: nacl.util.encodeBase64(ciphertext)\n  };\n};\n\nvar symDecryptBase = function symDecryptBase(ciphertext, symKey, nonce, toBuffer) {\n  ciphertext = nacl.util.decodeBase64(ciphertext);\n  nonce = nacl.util.decodeBase64(nonce);\n  var cleartext = nacl.secretbox.open(ciphertext, nonce, symKey);\n\n  if (toBuffer) {\n    return cleartext ? Buffer.from(cleartext) : null;\n  }\n\n  return cleartext ? nacl.util.encodeUTF8(cleartext) : null;\n};\n\nvar newSymKey = function newSymKey() {\n  return nacl.randomBytes(32);\n};\n\nmodule.exports = {\n  randomNonce: randomNonce,\n  symEncryptBase: symEncryptBase,\n  symDecryptBase: symDecryptBase,\n  newSymKey: newSymKey\n};","map":null,"metadata":{},"sourceType":"script"}