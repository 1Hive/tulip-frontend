{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar slicedToArray = require('./slicedToArray-a8a77f0e.js');\n\nrequire('./unsupportedIterableToArray-f175acfa.js');\n\nvar React = require('react');\n\nrequire('./_commonjsHelpers-1b94f6bc.js');\n\nvar index$1 = require('./index-46d0e707.js');\n\nrequire('./defineProperty-3cad0327.js');\n\nrequire('./toConsumableArray-cc0d28a9.js');\n\nvar _styled = require('styled-components');\n\nrequire('./getPrototypeOf-55c9e80c.js');\n\nrequire('./color.js');\n\nrequire('./components.js');\n\nvar css = require('./css.js');\n\nrequire('./miscellaneous.js');\n\nvar environment = require('./environment.js');\n\nrequire('./font.js');\n\nrequire('./keycodes.js');\n\nvar constants = require('./constants.js');\n\nrequire('./breakpoints.js');\n\nrequire('./springs.js');\n\nvar textStyles = require('./text-styles.js');\n\nrequire('./theme-dark.js');\n\nrequire('./theme-light.js');\n\nvar Theme = require('./Theme.js');\n\nvar _extends = require('./extends-023d783e.js');\n\nvar objectWithoutProperties = require('./objectWithoutProperties-c6d3675c.js');\n\nvar index = require('./index-4def0554.js');\n\nrequire('./_baseGetTag-42b4dd3e.js');\n\nvar Viewport = require('./Viewport-819c53c9.js');\n\nrequire('./FocusVisible.js');\n\nvar ButtonBase = require('./ButtonBase.js');\n\nrequire('./IconPropTypes-12cd7567.js');\n\nvar IconDown = require('./IconDown.js');\n\nrequire('./objectWithoutPropertiesLoose-1af20ad0.js');\n\nrequire('react-dom');\n\nrequire('./web-7cbdbd84.js');\n\nrequire('./Root-8693e46b.js');\n\nrequire('./RootPortal.js');\n\nrequire('./proptypes-9c58a90f.js');\n\nvar Popover = require('./Popover.js');\n\nfunction _interopDefaultLegacy(e) {\n  return e && typeof e === 'object' && 'default' in e ? e : {\n    'default': e\n  };\n}\n\nvar React__default = /*#__PURE__*/_interopDefaultLegacy(React);\n\nvar _styled__default = /*#__PURE__*/_interopDefaultLegacy(_styled);\n\nvar MIN_WIDTH = 128;\n\nfunction useDropDown(_ref) {\n  var buttonRef = _ref.buttonRef,\n      items = _ref.items,\n      displayedLabel = _ref.displayedLabel,\n      onChange = _ref.onChange,\n      placeholder = _ref.placeholder,\n      selected = _ref.selected;\n\n  var _useState = React.useState(displayedLabel),\n      _useState2 = slicedToArray.slicedToArray(_useState, 2),\n      selectedLabel = _useState2[0],\n      setSelectedLabel = _useState2[1];\n\n  var _useState3 = React.useState(false),\n      _useState4 = slicedToArray.slicedToArray(_useState3, 2),\n      opened = _useState4[0],\n      setOpened = _useState4[1];\n\n  var close = React.useCallback(function () {\n    setOpened(false);\n\n    if (buttonRef.current) {\n      buttonRef.current.focus();\n    }\n  }, [buttonRef]);\n  var toggle = React.useCallback(function () {\n    return setOpened(function (opened) {\n      return !opened;\n    });\n  }, []);\n  var handleItemSelect = React.useCallback(function (index) {\n    onChange(index);\n    close();\n  }, [onChange, close]);\n  React.useEffect(function () {\n    if (selected === -1 || !items[selected]) {\n      if (displayedLabel) {\n        setSelectedLabel(displayedLabel);\n      }\n\n      return;\n    }\n\n    setSelectedLabel(items[selected]);\n  }, [items, selected, displayedLabel]);\n  return {\n    handleItemSelect: handleItemSelect,\n    close: close,\n    toggle: toggle,\n    opened: opened,\n    selectedLabel: selectedLabel\n  };\n}\n\nfunction useButtonRef(cb) {\n  var buttonRef = React.useRef(null);\n  var refCallback = React.useCallback(function (el) {\n    if (el) {\n      cb(el);\n    }\n\n    buttonRef.current = el;\n  }, [cb]);\n  return {\n    buttonRef: buttonRef,\n    refCallback: refCallback\n  };\n}\n\nvar _StyledButtonBase = _styled__default['default'](ButtonBase.default).withConfig({\n  displayName: \"DropDown___StyledButtonBase\",\n  componentId: \"sc-17zpefi-0\"\n})([\"display:\", \";justify-content:space-between;align-items:center;height:\", \"px;padding-left:\", \"px;padding-right:\", \"px;width:\", \";min-width:\", \";background:\", \";color:\", \";border:\", \"px solid \", \";\", \";\", \"\"], function (p) {\n  return p._css;\n}, function (p) {\n  return p._css2;\n}, function (p) {\n  return p._css3;\n}, function (p) {\n  return p._css4;\n}, function (p) {\n  return p._css5;\n}, function (p) {\n  return p._css6;\n}, function (p) {\n  return p._css7;\n}, function (p) {\n  return p._css8;\n}, function (p) {\n  return p._css9;\n}, function (p) {\n  return p._css10;\n}, function (p) {\n  return p._css11;\n}, function (p) {\n  return p._css12;\n});\n\nvar _StyledDiv = _styled__default['default'](\"div\").withConfig({\n  displayName: \"DropDown___StyledDiv\",\n  componentId: \"sc-17zpefi-1\"\n})([\"overflow:hidden;\"]);\n\nvar _StyledIconDown = _styled__default['default'](IconDown.default).withConfig({\n  displayName: \"DropDown___StyledIconDown\",\n  componentId: \"sc-17zpefi-2\"\n})([\"margin-left:\", \"px;color:\", \";\"], function (p) {\n  return p._css13;\n}, function (p) {\n  return p._css14;\n});\n\nvar _StyledDiv2 = _styled__default['default'](\"div\").withConfig({\n  displayName: \"DropDown___StyledDiv2\",\n  componentId: \"sc-17zpefi-3\"\n})([\"position:absolute;top:-100vh;left:-100vw;opacity:0;visibility:hidden;\"]);\n\nvar DropDown = /*#__PURE__*/React__default['default'].memo(function DropDown(_ref2) {\n  var disabled = _ref2.disabled,\n      header = _ref2.header,\n      items = _ref2.items,\n      onChange = _ref2.onChange,\n      placeholder = _ref2.placeholder,\n      renderLabel = _ref2.renderLabel,\n      selected = _ref2.selected,\n      wide = _ref2.wide,\n      width = _ref2.width,\n      active = _ref2.active,\n      label = _ref2.label,\n      props = objectWithoutProperties.objectWithoutProperties(_ref2, [\"disabled\", \"header\", \"items\", \"onChange\", \"placeholder\", \"renderLabel\", \"selected\", \"wide\", \"width\", \"active\", \"label\"]);\n\n  if (active !== undefined) {\n    environment.warnOnce('DropDown:active', 'The “active” prop is deprecated. Please use “selected” to pass the selected index instead.');\n  }\n\n  if (label !== undefined) {\n    environment.warnOnce('DropDown:label', 'DropDown: the “label” prop is deprecated, please use “placeholder” instead.');\n  }\n\n  var theme = Theme.useTheme();\n\n  var _useViewport = Viewport.useViewport(),\n      vw = _useViewport.width;\n\n  var _split = (width || '').split('px'),\n      _split2 = slicedToArray.slicedToArray(_split, 1),\n      _split2$ = _split2[0],\n      widthNoPx = _split2$ === void 0 ? MIN_WIDTH : _split2$;\n\n  var _useState5 = React.useState(0),\n      _useState6 = slicedToArray.slicedToArray(_useState5, 2),\n      buttonWidth = _useState6[0],\n      setButtonWidth = _useState6[1];\n\n  var _useState7 = React.useState(true),\n      _useState8 = slicedToArray.slicedToArray(_useState7, 2),\n      measureWidth = _useState8[0],\n      setMeasureWidth = _useState8[1]; // Adjust the button width if the item widths are larger than declared width\n\n\n  var _useState9 = React.useState(Math.min(widthNoPx, MIN_WIDTH)),\n      _useState10 = slicedToArray.slicedToArray(_useState9, 2),\n      placeholderMinWidth = _useState10[0],\n      setPlaceholderMinWidth = _useState10[1];\n\n  var popoverRefCallback = React.useCallback(function (el) {\n    if (!el) {\n      return;\n    }\n\n    setPlaceholderMinWidth(el.clientWidth);\n    setMeasureWidth(false);\n  }, []);\n  React.useEffect(function () {\n    setMeasureWidth(true);\n  }, [vw, items]); // Update the button width every time the reference updates\n\n  var _useButtonRef = useButtonRef(function (el) {\n    setButtonWidth(el.clientWidth);\n  }),\n      refCallback = _useButtonRef.refCallback,\n      buttonRef = _useButtonRef.buttonRef; // And every time the viewport resizes\n\n\n  React.useEffect(function () {\n    if (!buttonRef.current) {\n      return;\n    }\n\n    setButtonWidth(buttonRef.current.clientWidth);\n  }, [buttonRef, vw]);\n  var selectedIndex = React.useMemo(function () {\n    if (selected !== undefined) {\n      return selected;\n    }\n\n    if (active !== undefined) {\n      return active;\n    }\n\n    return -1;\n  }, [active, selected]);\n\n  var _useDropDown = useDropDown({\n    buttonRef: buttonRef,\n    displayedLabel: placeholder || label,\n    items: items,\n    onChange: onChange,\n    selected: selected\n  }),\n      handleItemSelect = _useDropDown.handleItemSelect,\n      close = _useDropDown.close,\n      toggle = _useDropDown.toggle,\n      opened = _useDropDown.opened,\n      selectedLabel = _useDropDown.selectedLabel;\n\n  var closedWithChanges = !opened && selectedIndex !== -1;\n  var Label = renderLabel;\n  return /*#__PURE__*/React__default['default'].createElement(index.i, {\n    name: \"DropDown\"\n  }, /*#__PURE__*/React__default['default'].createElement(_StyledButtonBase, _extends._extends_1({\n    ref: refCallback,\n    disabled: disabled,\n    onClick: toggle,\n    focusRingRadius: constants.RADIUS,\n    focusRingSpacing: 1\n  }, props, {\n    _css: wide ? 'flex' : 'inline-flex',\n    _css2: 5 * constants.GU,\n    _css3: 2 * constants.GU,\n    _css4: 1.5 * constants.GU,\n    _css5: width || (wide ? '100%' : 'auto'),\n    _css6: wide ? 'auto' : \"\".concat(placeholderMinWidth, \"px\"),\n    _css7: disabled ? theme.disabled : theme.surface,\n    _css8: disabled ? theme.disabledContent : theme.surfaceContent,\n    _css9: disabled ? 0 : 1,\n    _css10: closedWithChanges ? theme.selected : theme.border,\n    _css11: textStyles.textStyle('body2'),\n    _css12: disabled ? 'font-weight: 600;' : \"\\n              &:active {\\n                background: \".concat(theme.surfacePressed, \";\\n              }\\n            \")\n  }), /*#__PURE__*/React__default['default'].createElement(_StyledDiv, null, /*#__PURE__*/React__default['default'].createElement(Label, {\n    selectedIndex: selectedIndex,\n    selectedLabel: selectedLabel\n  })), /*#__PURE__*/React__default['default'].createElement(_StyledIconDown, {\n    size: \"tiny\",\n    _css13: 1.5 * constants.GU,\n    _css14: disabled ? theme.disabledIcon : closedWithChanges ? theme.accent : theme.surfaceIcon\n  })), measureWidth && /*#__PURE__*/React__default['default'].createElement(_StyledDiv2, null, /*#__PURE__*/React__default['default'].createElement(PopoverContent, {\n    refCallback: popoverRefCallback,\n    buttonWidth: buttonWidth,\n    header: header,\n    items: items\n  })), /*#__PURE__*/React__default['default'].createElement(Popover.default, {\n    onClose: close,\n    opener: buttonRef.current,\n    visible: opened\n  }, /*#__PURE__*/React__default['default'].createElement(PopoverContent, {\n    buttonWidth: buttonWidth,\n    header: header,\n    items: items,\n    handleItemSelect: handleItemSelect,\n    selectedIndex: selectedIndex\n  })));\n});\nDropDown.propTypes = {\n  disabled: index$1.propTypes.bool,\n  header: index$1.propTypes.node,\n  items: index$1.propTypes.arrayOf(index$1.propTypes.node).isRequired,\n  onChange: index$1.propTypes.func.isRequired,\n  placeholder: index$1.propTypes.node,\n  renderLabel: index$1.propTypes.func,\n  selected: index$1.propTypes.number,\n  wide: index$1.propTypes.bool,\n  width: index$1.propTypes.string,\n  // deprecated\n  active: index$1.propTypes.number,\n  label: index$1.propTypes.string\n};\nDropDown.defaultProps = {\n  placeholder: 'Select an item',\n  renderLabel: function renderLabel(_ref3) {\n    var selectedLabel = _ref3.selectedLabel;\n    return selectedLabel;\n  },\n  wide: false\n};\n\nvar _StyledDiv3 = _styled__default['default'](\"div\").withConfig({\n  displayName: \"DropDown___StyledDiv3\",\n  componentId: \"sc-17zpefi-4\"\n})([\"min-width:\", \"px;color:\", \";\"], function (p) {\n  return p._css15;\n}, function (p) {\n  return p._css16;\n});\n\nvar _StyledDiv4 = _styled__default['default'](\"div\").withConfig({\n  displayName: \"DropDown___StyledDiv4\",\n  componentId: \"sc-17zpefi-5\"\n})([\"padding:\", \"px \", \"px \", \"px;\", \";\", \";\"], function (p) {\n  return p._css17;\n}, function (p) {\n  return p._css18;\n}, function (p) {\n  return p._css19;\n}, function (p) {\n  return p._css20;\n}, css.unselectable);\n\nvar _StyledUl = _styled__default['default'](\"ul\").withConfig({\n  displayName: \"DropDown___StyledUl\",\n  componentId: \"sc-17zpefi-6\"\n})([\"margin:0;padding:0;list-style:none;width:100%;\"]);\n\nvar PopoverContent = /*#__PURE__*/React__default['default'].memo(function PopoverContent(_ref4) {\n  var refCallback = _ref4.refCallback,\n      buttonWidth = _ref4.buttonWidth,\n      header = _ref4.header,\n      items = _ref4.items,\n      handleItemSelect = _ref4.handleItemSelect,\n      selectedIndex = _ref4.selectedIndex;\n  var theme = Theme.useTheme();\n  return /*#__PURE__*/React__default['default'].createElement(_StyledDiv3, {\n    _css15: buttonWidth,\n    _css16: theme.surfaceContentSecondary\n  }, header && /*#__PURE__*/React__default['default'].createElement(_StyledDiv4, {\n    _css17: 1.5 * constants.GU,\n    _css18: 2 * constants.GU,\n    _css19: 1.25 * constants.GU,\n    _css20: textStyles.textStyle('label2')\n  }, header), /*#__PURE__*/React__default['default'].createElement(_StyledUl, {\n    ref: refCallback\n  }, /*#__PURE__*/React__default['default'].createElement(index.i, {\n    name: \"DropDown:menu\"\n  }, items.map(function (item, index) {\n    return /*#__PURE__*/React__default['default'].createElement(Item, {\n      key: index,\n      index: index,\n      onSelect: handleItemSelect,\n      theme: theme,\n      item: item,\n      header: header,\n      length: items.length,\n      selected: selectedIndex\n    });\n  }))));\n});\nPopoverContent.propTypes = {\n  refCallback: index$1.propTypes.func.isRequired,\n  buttonWidth: index$1.propTypes.number.isRequired,\n  header: index$1.propTypes.node,\n  items: index$1.propTypes.array.isRequired,\n  handleItemSelect: index$1.propTypes.func.isRequired,\n  selectedIndex: index$1.propTypes.number.isRequired\n};\nPopoverContent.defaultProps = {\n  refCallback: function refCallback() {\n    return null;\n  },\n  handleItemSelect: function handleItemSelect() {\n    return null;\n  },\n  selectedIndex: -1\n};\n\nvar _StyledButtonBase2 = _styled__default['default'](ButtonBase.default).withConfig({\n  displayName: \"DropDown___StyledButtonBase2\",\n  componentId: \"sc-17zpefi-7\"\n})([\"width:100%;text-align:left;padding:\", \"px \", \"px;border-radius:0;color:\", \";\", \";\", \" \", \" \", \" &:active{background:\", \";}\"], function (p) {\n  return p._css21;\n}, function (p) {\n  return p._css22;\n}, function (p) {\n  return p._css23;\n}, function (p) {\n  return p._css24;\n}, function (p) {\n  return p._css25;\n}, function (p) {\n  return p._css26;\n}, function (p) {\n  return p._css27;\n}, function (p) {\n  return p._css28;\n});\n\nvar Item = /*#__PURE__*/React__default['default'].memo(function Item(_ref5) {\n  var header = _ref5.header,\n      index = _ref5.index,\n      item = _ref5.item,\n      length = _ref5.length,\n      onSelect = _ref5.onSelect,\n      selected = _ref5.selected,\n      theme = _ref5.theme;\n  var handleClick = React.useCallback(function () {\n    onSelect(index);\n  }, [index, onSelect]);\n  return /*#__PURE__*/React__default['default'].createElement(\"li\", null, /*#__PURE__*/React__default['default'].createElement(_StyledButtonBase2, {\n    onClick: handleClick,\n    _css21: 1.25 * constants.GU,\n    _css22: 2 * constants.GU,\n    _css23: theme.content,\n    _css24: textStyles.textStyle('body2'),\n    _css25: !header && index === 0 ? \"border-top-left-radius: \".concat(constants.RADIUS, \"px;\") : '',\n    _css26: index === length - 1 ? \"border-bottom-left-radius: \".concat(constants.RADIUS, \"px;\") : '',\n    _css27: selected === index ? \"\\n              border-left: 2px solid \".concat(theme.accent, \";\\n              background: \").concat(theme.surfaceSelected, \";\\n            \") : '',\n    _css28: theme.surfacePressed\n  }, item));\n});\nItem.propTypes = {\n  header: index$1.propTypes.node,\n  index: index$1.propTypes.number.isRequired,\n  item: index$1.propTypes.node.isRequired,\n  length: index$1.propTypes.number.isRequired,\n  onSelect: index$1.propTypes.func.isRequired,\n  selected: index$1.propTypes.number.isRequired,\n  theme: index$1.propTypes.object.isRequired\n};\nexports.default = DropDown;","map":{"version":3,"sources":["../src/components/DropDown/DropDown.js"],"names":["MIN_WIDTH","buttonRef","items","displayedLabel","onChange","placeholder","selected","selectedLabel","setSelectedLabel","useState","opened","setOpened","close","useCallback","toggle","handleItemSelect","useEffect","useRef","refCallback","cb","DropDown","disabled","header","renderLabel","wide","width","active","label","props","warnOnce","theme","useTheme","vw","useViewport","widthNoPx","buttonWidth","setButtonWidth","measureWidth","setMeasureWidth","placeholderMinWidth","setPlaceholderMinWidth","Math","popoverRefCallback","el","useButtonRef","selectedIndex","useMemo","useDropDown","closedWithChanges","Label","Inside","RADIUS","GU","textStyle","surfaceIcon","Popover","PropTypes","string","PopoverContent","surfaceContentSecondary","unselectable","isRequired","Item","index","item","length","onSelect","handleClick","surfacePressed"],"mappings":"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","sourcesContent":["import React, { useState, useRef, useEffect, useCallback, useMemo } from 'react'\nimport PropTypes from 'prop-types'\nimport { Inside } from 'use-inside'\nimport { warnOnce, unselectable } from '../../utils'\nimport { GU, RADIUS, textStyle } from '../../style'\nimport { useTheme } from '../../theme'\nimport { IconDown } from '../../icons'\nimport { useViewport } from '../../providers/Viewport/Viewport'\nimport ButtonBase from '../ButtonBase/ButtonBase'\nimport Popover from '../Popover/Popover'\n\nconst MIN_WIDTH = 128\n\nfunction useDropDown({\n  buttonRef,\n  items,\n  displayedLabel,\n  onChange,\n  placeholder,\n  selected,\n}) {\n  const [selectedLabel, setSelectedLabel] = useState(displayedLabel)\n  const [opened, setOpened] = useState(false)\n\n  const close = useCallback(() => {\n    setOpened(false)\n\n    if (buttonRef.current) {\n      buttonRef.current.focus()\n    }\n  }, [buttonRef])\n\n  const toggle = useCallback(() => setOpened(opened => !opened), [])\n\n  const handleItemSelect = useCallback(\n    index => {\n      onChange(index)\n      close()\n    },\n    [onChange, close]\n  )\n\n  useEffect(() => {\n    if (selected === -1 || !items[selected]) {\n      if (displayedLabel) {\n        setSelectedLabel(displayedLabel)\n      }\n      return\n    }\n    setSelectedLabel(items[selected])\n  }, [items, selected, displayedLabel])\n\n  return {\n    handleItemSelect,\n    close,\n    toggle,\n    opened,\n    selectedLabel,\n  }\n}\n\nfunction useButtonRef(cb) {\n  const buttonRef = useRef(null)\n\n  const refCallback = useCallback(\n    el => {\n      if (el) {\n        cb(el)\n      }\n      buttonRef.current = el\n    },\n    [cb]\n  )\n\n  return {\n    buttonRef,\n    refCallback,\n  }\n}\n\nconst DropDown = React.memo(function DropDown({\n  disabled,\n  header,\n  items,\n  onChange,\n  placeholder,\n  renderLabel,\n  selected,\n  wide,\n  width,\n\n  // deprecated\n  active,\n  label,\n\n  // rest\n  ...props\n}) {\n  if (active !== undefined) {\n    warnOnce(\n      'DropDown:active',\n      'The “active” prop is deprecated. Please use “selected” to pass the selected index instead.'\n    )\n  }\n  if (label !== undefined) {\n    warnOnce(\n      'DropDown:label',\n      'DropDown: the “label” prop is deprecated, please use “placeholder” instead.'\n    )\n  }\n\n  const theme = useTheme()\n  const { width: vw } = useViewport()\n\n  const [widthNoPx = MIN_WIDTH] = (width || '').split('px')\n  const [buttonWidth, setButtonWidth] = useState(0)\n  const [measureWidth, setMeasureWidth] = useState(true)\n\n  // Adjust the button width if the item widths are larger than declared width\n  const [placeholderMinWidth, setPlaceholderMinWidth] = useState(\n    Math.min(widthNoPx, MIN_WIDTH)\n  )\n  const popoverRefCallback = useCallback(el => {\n    if (!el) {\n      return\n    }\n    setPlaceholderMinWidth(el.clientWidth)\n    setMeasureWidth(false)\n  }, [])\n  useEffect(() => {\n    setMeasureWidth(true)\n  }, [vw, items])\n\n  // Update the button width every time the reference updates\n  const { refCallback, buttonRef } = useButtonRef(el => {\n    setButtonWidth(el.clientWidth)\n  })\n  // And every time the viewport resizes\n  useEffect(() => {\n    if (!buttonRef.current) {\n      return\n    }\n    setButtonWidth(buttonRef.current.clientWidth)\n  }, [buttonRef, vw])\n\n  const selectedIndex = useMemo(() => {\n    if (selected !== undefined) {\n      return selected\n    }\n    if (active !== undefined) {\n      return active\n    }\n    return -1\n  }, [active, selected])\n\n  const {\n    handleItemSelect,\n    close,\n    toggle,\n    opened,\n    selectedLabel,\n  } = useDropDown({\n    buttonRef,\n    displayedLabel: placeholder || label,\n    items,\n    onChange,\n    selected,\n  })\n\n  const closedWithChanges = !opened && selectedIndex !== -1\n  const Label = renderLabel\n\n  return (\n    <Inside name=\"DropDown\">\n      <ButtonBase\n        ref={refCallback}\n        disabled={disabled}\n        onClick={toggle}\n        focusRingRadius={RADIUS}\n        focusRingSpacing={1}\n        css={`\n          display: ${wide ? 'flex' : 'inline-flex'};\n          justify-content: space-between;\n          align-items: center;\n          height: ${5 * GU}px;\n          padding-left: ${2 * GU}px;\n          padding-right: ${1.5 * GU}px;\n          width: ${width || (wide ? '100%' : 'auto')};\n          min-width: ${wide ? 'auto' : `${placeholderMinWidth}px`};\n          background: ${disabled ? theme.disabled : theme.surface};\n          color: ${disabled ? theme.disabledContent : theme.surfaceContent};\n          border: ${disabled ? 0 : 1}px solid\n            ${closedWithChanges ? theme.selected : theme.border};\n          ${textStyle('body2')};\n          ${disabled\n            ? 'font-weight: 600;'\n            : `\n              &:active {\n                background: ${theme.surfacePressed};\n              }\n            `}\n        `}\n        {...props}\n      >\n        <div css=\"overflow: hidden;\">\n          <Label selectedIndex={selectedIndex} selectedLabel={selectedLabel} />\n        </div>\n        <IconDown\n          size=\"tiny\"\n          css={`\n            margin-left: ${1.5 * GU}px;\n            color: ${disabled\n              ? theme.disabledIcon\n              : closedWithChanges\n              ? theme.accent\n              : theme.surfaceIcon};\n          `}\n        />\n      </ButtonBase>\n      {measureWidth && (\n        <div\n          css={`\n            position: absolute;\n            top: -100vh;\n            left: -100vw;\n            opacity: 0;\n            visibility: hidden;\n          `}\n        >\n          <PopoverContent\n            refCallback={popoverRefCallback}\n            buttonWidth={buttonWidth}\n            header={header}\n            items={items}\n          />\n        </div>\n      )}\n      <Popover onClose={close} opener={buttonRef.current} visible={opened}>\n        <PopoverContent\n          buttonWidth={buttonWidth}\n          header={header}\n          items={items}\n          handleItemSelect={handleItemSelect}\n          selectedIndex={selectedIndex}\n        />\n      </Popover>\n    </Inside>\n  )\n})\n\nDropDown.propTypes = {\n  disabled: PropTypes.bool,\n  header: PropTypes.node,\n  items: PropTypes.arrayOf(PropTypes.node).isRequired,\n  onChange: PropTypes.func.isRequired,\n  placeholder: PropTypes.node,\n  renderLabel: PropTypes.func,\n  selected: PropTypes.number,\n  wide: PropTypes.bool,\n  width: PropTypes.string,\n\n  // deprecated\n  active: PropTypes.number,\n  label: PropTypes.string,\n}\n\nDropDown.defaultProps = {\n  placeholder: 'Select an item',\n  renderLabel: ({ selectedLabel }) => selectedLabel,\n  wide: false,\n}\n\nconst PopoverContent = React.memo(function PopoverContent({\n  refCallback,\n  buttonWidth,\n  header,\n  items,\n  handleItemSelect,\n  selectedIndex,\n}) {\n  const theme = useTheme()\n  return (\n    <div\n      css={`\n        min-width: ${buttonWidth}px;\n        color: ${theme.surfaceContentSecondary};\n      `}\n    >\n      {header && (\n        <div\n          css={`\n            padding: ${1.5 * GU}px ${2 * GU}px ${1.25 * GU}px;\n            ${textStyle('label2')};\n            ${unselectable};\n          `}\n        >\n          {header}\n        </div>\n      )}\n      <ul\n        ref={refCallback}\n        css={`\n          margin: 0;\n          padding: 0;\n          list-style: none;\n          width: 100%;\n        `}\n      >\n        <Inside name=\"DropDown:menu\">\n          {items.map((item, index) => {\n            return (\n              <Item\n                key={index}\n                index={index}\n                onSelect={handleItemSelect}\n                theme={theme}\n                item={item}\n                header={header}\n                length={items.length}\n                selected={selectedIndex}\n              />\n            )\n          })}\n        </Inside>\n      </ul>\n    </div>\n  )\n})\n\nPopoverContent.propTypes = {\n  refCallback: PropTypes.func.isRequired,\n  buttonWidth: PropTypes.number.isRequired,\n  header: PropTypes.node,\n  items: PropTypes.array.isRequired,\n  handleItemSelect: PropTypes.func.isRequired,\n  selectedIndex: PropTypes.number.isRequired,\n}\n\nPopoverContent.defaultProps = {\n  refCallback: () => null,\n  handleItemSelect: () => null,\n  selectedIndex: -1,\n}\n\nconst Item = React.memo(function Item({\n  header,\n  index,\n  item,\n  length,\n  onSelect,\n  selected,\n  theme,\n}) {\n  const handleClick = useCallback(() => {\n    onSelect(index)\n  }, [index, onSelect])\n\n  return (\n    <li>\n      <ButtonBase\n        onClick={handleClick}\n        css={`\n          width: 100%;\n          text-align: left;\n          padding: ${1.25 * GU}px ${2 * GU}px;\n          border-radius: 0;\n          color: ${theme.content};\n\n          ${textStyle('body2')};\n          ${\n            !header && index === 0 ? `border-top-left-radius: ${RADIUS}px;` : ''\n          }\n          ${\n            index === length - 1\n              ? `border-bottom-left-radius: ${RADIUS}px;`\n              : ''\n          }\n          ${\n            selected === index\n              ? `\n              border-left: 2px solid ${theme.accent};\n              background: ${theme.surfaceSelected};\n            `\n              : ''\n          }\n\n          &:active {\n            background: ${theme.surfacePressed};\n          }\n        `}\n      >\n        {item}\n      </ButtonBase>\n    </li>\n  )\n})\n\nItem.propTypes = {\n  header: PropTypes.node,\n  index: PropTypes.number.isRequired,\n  item: PropTypes.node.isRequired,\n  length: PropTypes.number.isRequired,\n  onSelect: PropTypes.func.isRequired,\n  selected: PropTypes.number.isRequired,\n  theme: PropTypes.object.isRequired,\n}\n\nexport default DropDown\n"]},"metadata":{},"sourceType":"script"}