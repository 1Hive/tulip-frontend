{"ast":null,"code":"'use strict';\n\nconst forge = {\n  util: require('node-forge/lib/util'),\n  pki: require('node-forge/lib/pki'),\n  jsbn: require('node-forge/lib/jsbn')\n};\n\nfunction base64urlToBigInteger(str) {\n  var bytes = forge.util.decode64((str + '==='.slice((str.length + 3) % 4)).replace(/-/g, '+').replace(/_/g, '/'));\n  return new forge.jsbn.BigInteger(forge.util.bytesToHex(bytes), 16);\n}\n\nfunction convert(key, types) {\n  return types.map(t => base64urlToBigInteger(key[t]));\n}\n\nfunction jwk2priv(key) {\n  return forge.pki.setRsaPrivateKey(...convert(key, ['n', 'e', 'd', 'p', 'q', 'dp', 'dq', 'qi']));\n}\n\nfunction jwk2privPem(key) {\n  return forge.pki.privateKeyToPem(jwk2priv(key));\n}\n\nfunction jwk2pub(key) {\n  return forge.pki.setRsaPublicKey(...convert(key, ['n', 'e']));\n}\n\nfunction jwk2pubPem(key) {\n  return forge.pki.publicKeyToPem(jwk2pub(key));\n}\n\nmodule.exports = {\n  jwk2pub,\n  jwk2pubPem,\n  jwk2priv,\n  jwk2privPem\n};","map":null,"metadata":{},"sourceType":"script"}