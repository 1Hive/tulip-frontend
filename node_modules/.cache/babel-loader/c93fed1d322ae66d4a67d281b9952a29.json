{"ast":null,"code":"'use strict';\n\nvar React = require('react');\n\nvar index = require('./index-46d0e707.js');\n\nvar defineProperty = require('./defineProperty-3cad0327.js');\n\nvar getPrototypeOf = require('./getPrototypeOf-55c9e80c.js');\n\nvar dayjs_min = require('./dayjs.min-ac79806e.js');\n\nvar date = require('./date.js');\n\nvar getDisplayName = require('./getDisplayName-7f913e84.js');\n\nfunction _interopDefaultLegacy(e) {\n  return e && typeof e === 'object' && 'default' in e ? e : {\n    'default': e\n  };\n}\n\nvar React__default = /*#__PURE__*/_interopDefaultLegacy(React);\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = getPrototypeOf.getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = getPrototypeOf.getPrototypeOf(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return getPrototypeOf.possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n} // adjusts the re-render timer to be one second, minute, or hour based on the\n// fromDate prop.\n// For a discussion on pitfalls, see\n// https://gist.github.com/staltz/08bf613199092eeb41ac8137d51eb5e6\n\n\nvar EVERY_SECOND = 1000;\nvar EVERY_MINUTE = EVERY_SECOND * 60;\nvar EVERY_HOUR = EVERY_MINUTE * 60;\n\nvar getRedrawTime = function getRedrawTime(fromDate) {\n  var _difference = date.difference(new Date(), fromDate),\n      days = _difference.days,\n      hours = _difference.hours,\n      minutes = _difference.minutes;\n\n  return hours || days ? EVERY_HOUR : minutes > 1 ? EVERY_MINUTE : EVERY_SECOND;\n};\n\nvar RedrawFromDate = /*#__PURE__*/function (_React$Component) {\n  getPrototypeOf.inherits(RedrawFromDate, _React$Component);\n\n  var _super = _createSuper(RedrawFromDate);\n\n  function RedrawFromDate() {\n    var _this;\n\n    getPrototypeOf.classCallCheck(this, RedrawFromDate);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    defineProperty.defineProperty(getPrototypeOf.assertThisInitialized(_this), \"state\", {\n      redrawTime: EVERY_HOUR,\n      lastDraw: -1\n    });\n    defineProperty.defineProperty(getPrototypeOf.assertThisInitialized(_this), \"clearInterval\", function () {\n      _this.interval && clearInterval(_this.interval);\n    });\n    defineProperty.defineProperty(getPrototypeOf.assertThisInitialized(_this), \"restartDrawInterval\", function (redrawTime) {\n      _this.clearInterval();\n\n      _this.interval = setInterval(function () {\n        _this.setState({\n          lastDraw: Date.now()\n        });\n\n        var newRedrawTime = getRedrawTime(_this.props.fromDate);\n\n        if (newRedrawTime !== redrawTime) {\n          _this.restartDrawInterval(newRedrawTime);\n        }\n      }, redrawTime);\n    });\n    return _this;\n  }\n\n  getPrototypeOf.createClass(RedrawFromDate, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var fromDate = this.props.fromDate;\n\n      if (fromDate) {\n        this.restartDrawInterval(getRedrawTime(fromDate));\n      }\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(_ref) {\n      var fromDate = _ref.fromDate;\n\n      if (!fromDate && this.props.fromDate) {\n        this.clearInterval();\n      } else if (!dayjs_min.dayjs_min(fromDate).isSame(this.props.fromDate)) {\n        this.restartDrawInterval(getRedrawTime(this.props.fromDate));\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.clearInterval();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return this.props.children();\n    }\n  }]);\n  return RedrawFromDate;\n}(React__default['default'].Component);\n\ndefineProperty.defineProperty(RedrawFromDate, \"propTypes\", {\n  children: index.propTypes.func.isRequired,\n  fromDate: index.propTypes.oneOfType([index.propTypes.string, index.propTypes.number, index.propTypes.instanceOf(Date)]).isRequired\n});\n\nvar hocWrap = function hocWrap(Component) {\n  var HOC = function HOC(props) {\n    return /*#__PURE__*/React__default['default'].createElement(RedrawFromDate, {\n      fromDate: props.fromDate\n    }, function () {\n      return /*#__PURE__*/React__default['default'].createElement(Component, props);\n    });\n  };\n\n  HOC.propTypes = {\n    fromDate: RedrawFromDate.propTypes.fromDate\n  };\n  HOC.displayName = \"RedrawFromDate(\".concat(getDisplayName.getDisplayName(Component), \")\");\n  return HOC;\n};\n\nRedrawFromDate.hocWrap = hocWrap;\nexports.RedrawFromDate = RedrawFromDate;","map":{"version":3,"sources":["../src/providers/RedrawFromDate/RedrawFromDate.js"],"names":["EVERY_SECOND","EVERY_MINUTE","EVERY_HOUR","getRedrawTime","days","hours","minutes","difference","RedrawFromDate","React","Component","children","PropTypes","fromDate","isRequired","redrawTime","lastDraw","dayjs","clearInterval","setInterval","Date","newRedrawTime","hocWrap","HOC","props","getDisplayName"],"mappings":"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","sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\nimport getDisplayName from 'react-display-name'\nimport dayjs from 'dayjs'\nimport { difference } from '../../utils/date'\n\n// Render prop component for re-rendering based on a given date. Automatically\n// adjusts the re-render timer to be one second, minute, or hour based on the\n// fromDate prop.\n// For a discussion on pitfalls, see\n// https://gist.github.com/staltz/08bf613199092eeb41ac8137d51eb5e6\n\nconst EVERY_SECOND = 1000\nconst EVERY_MINUTE = EVERY_SECOND * 60\nconst EVERY_HOUR = EVERY_MINUTE * 60\n\nconst getRedrawTime = fromDate => {\n  const { days, hours, minutes } = difference(new Date(), fromDate)\n  return hours || days ? EVERY_HOUR : minutes > 1 ? EVERY_MINUTE : EVERY_SECOND\n}\n\nclass RedrawFromDate extends React.Component {\n  static propTypes = {\n    children: PropTypes.func.isRequired,\n    fromDate: PropTypes.oneOfType([\n      PropTypes.string,\n      PropTypes.number,\n      PropTypes.instanceOf(Date),\n    ]).isRequired,\n  }\n  state = {\n    redrawTime: EVERY_HOUR,\n    lastDraw: -1,\n  }\n  componentDidMount() {\n    const { fromDate } = this.props\n    if (fromDate) {\n      this.restartDrawInterval(getRedrawTime(fromDate))\n    }\n  }\n  componentWillReceiveProps({ fromDate }) {\n    if (!fromDate && this.props.fromDate) {\n      this.clearInterval()\n    } else if (!dayjs(fromDate).isSame(this.props.fromDate)) {\n      this.restartDrawInterval(getRedrawTime(this.props.fromDate))\n    }\n  }\n  componentWillUnmount() {\n    this.clearInterval()\n  }\n  clearInterval = () => {\n    this.interval && clearInterval(this.interval)\n  }\n  restartDrawInterval = redrawTime => {\n    this.clearInterval()\n\n    this.interval = setInterval(() => {\n      this.setState({ lastDraw: Date.now() })\n\n      const newRedrawTime = getRedrawTime(this.props.fromDate)\n      if (newRedrawTime !== redrawTime) {\n        this.restartDrawInterval(newRedrawTime)\n      }\n    }, redrawTime)\n  }\n  render() {\n    return this.props.children()\n  }\n}\n\nconst hocWrap = Component => {\n  const HOC = props => (\n    <RedrawFromDate fromDate={props.fromDate}>\n      {() => <Component {...props} />}\n    </RedrawFromDate>\n  )\n  HOC.propTypes = {\n    fromDate: RedrawFromDate.propTypes.fromDate,\n  }\n  HOC.displayName = `RedrawFromDate(${getDisplayName(Component)})`\n  return HOC\n}\n\nRedrawFromDate.hocWrap = hocWrap\n\nexport { RedrawFromDate, hocWrap }\nexport default RedrawFromDate\n"]},"metadata":{},"sourceType":"script"}