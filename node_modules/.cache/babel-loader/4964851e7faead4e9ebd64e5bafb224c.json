{"ast":null,"code":"var _jsxFileName = \"/Users/fabian/Documents/Projects/1hive/tulip-frontend/src/views/Lottery/components/TicketCard/BuyTicketModal.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useCallback, useMemo, useState } from 'react';\nimport styled from 'styled-components';\nimport { Button, Modal } from '@pancakeswap-libs/uikit';\nimport { getFullDisplayBalance } from 'utils/formatBalance';\nimport TicketInput from 'components/TicketInput';\nimport ModalActions from 'components/ModalActions';\nimport { useMultiBuyLottery, useMaxNumber } from 'hooks/useBuyLottery';\nimport useI18n from 'hooks/useI18n';\nimport { LOTTERY_MAX_NUMBER_OF_TICKETS, LOTTERY_TICKET_PRICE } from 'config';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst BuyTicketModal = ({\n  max,\n  onDismiss\n}) => {\n  _s();\n\n  const [val, setVal] = useState('1');\n  const [pendingTx, setPendingTx] = useState(false);\n  const [, setRequestedBuy] = useState(false);\n  const TranslateString = useI18n();\n  const fullBalance = useMemo(() => {\n    return getFullDisplayBalance(max);\n  }, [max]);\n  const maxTickets = useMemo(() => {\n    return parseInt(getFullDisplayBalance(max.div(LOTTERY_TICKET_PRICE)), 10);\n  }, [max]);\n\n  const handleChange = e => setVal(e.currentTarget.value);\n\n  const {\n    onMultiBuy\n  } = useMultiBuyLottery();\n  const maxNumber = useMaxNumber();\n  const handleBuy = useCallback(async () => {\n    try {\n      setRequestedBuy(true);\n      const length = parseInt(val); // @ts-ignore\n      // eslint-disable-next-line prefer-spread\n\n      const numbers = Array.apply(null, {\n        length\n      }).map(() => [Math.floor(Math.random() * maxNumber) + 1, Math.floor(Math.random() * maxNumber) + 1, Math.floor(Math.random() * maxNumber) + 1, Math.floor(Math.random() * maxNumber) + 1]);\n      const txHash = await onMultiBuy(LOTTERY_TICKET_PRICE.toString(), numbers); // user rejected tx or didn't go thru\n\n      if (txHash) {\n        setRequestedBuy(false);\n      }\n    } catch (e) {\n      console.error(e);\n    }\n  }, [onMultiBuy, setRequestedBuy, maxNumber, val]);\n  const handleSelectMax = useCallback(() => {\n    if (Number(maxTickets) > LOTTERY_MAX_NUMBER_OF_TICKETS) {\n      setVal(LOTTERY_MAX_NUMBER_OF_TICKETS.toString());\n    } else {\n      setVal(maxTickets.toString());\n    }\n  }, [maxTickets]);\n\n  const cakeCosts = amount => {\n    return +amount * LOTTERY_TICKET_PRICE;\n  };\n\n  return /*#__PURE__*/_jsxDEV(Modal, {\n    title: TranslateString(450, 'Enter amount of tickets to buy'),\n    onDismiss: onDismiss,\n    children: [/*#__PURE__*/_jsxDEV(TicketInput, {\n      value: val,\n      onSelectMax: handleSelectMax,\n      onChange: handleChange,\n      max: fullBalance,\n      symbol: \"TICKET\",\n      availableSymbol: \"CAKE\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(Tips, {\n        children: TranslateString(999, `1 Ticket = ${LOTTERY_TICKET_PRICE} CAKE`, {\n          num: LOTTERY_TICKET_PRICE\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Announce, {\n        children: TranslateString(478, 'Ticket purchases are final. Your CAKE cannot be returned to you after buying tickets.')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Final, {\n        children: TranslateString(460, `You will spend: ${cakeCosts(val)} CAKE`)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ModalActions, {\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        fullWidth: true,\n        variant: \"secondary\",\n        onClick: onDismiss,\n        children: TranslateString(462, 'Cancel')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        id: \"lottery-buy-complete\",\n        fullWidth: true,\n        disabled: pendingTx || parseInt(val) > Number(maxTickets) || parseInt(val) > LOTTERY_MAX_NUMBER_OF_TICKETS || parseInt(val) < 1,\n        onClick: async () => {\n          setPendingTx(true);\n          await handleBuy();\n          setPendingTx(false);\n          onDismiss();\n        },\n        children: pendingTx ? TranslateString(488, 'Pending Confirmation') : TranslateString(464, 'Confirm')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 5\n  }, this);\n};\n\n_s(BuyTicketModal, \"HrY5Mwzj03vSINEVS6ihQccgxJA=\", false, function () {\n  return [useI18n, useMultiBuyLottery, useMaxNumber];\n});\n\n_c = BuyTicketModal;\nexport default BuyTicketModal;\nconst Tips = styled.div`\n  margin-left: 0.4em;\n  font-size: 14px;\n  font-weight: 600;\n  color: ${props => props.theme.colors.primary};\n`;\n_c2 = Tips;\nconst Final = styled.div`\n  margin-top: 1em;\n  text-align: center;\n  font-size: 20px;\n  font-weight: 600;\n  color: ${props => props.theme.colors.primary};\n`;\n_c3 = Final;\nconst Announce = styled.div`\n  margin-top: 1em;\n  margin-left: 0.4em;\n  color: #ed4b9e;\n`;\n_c4 = Announce;\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"BuyTicketModal\");\n$RefreshReg$(_c2, \"Tips\");\n$RefreshReg$(_c3, \"Final\");\n$RefreshReg$(_c4, \"Announce\");","map":{"version":3,"sources":["/Users/fabian/Documents/Projects/1hive/tulip-frontend/src/views/Lottery/components/TicketCard/BuyTicketModal.tsx"],"names":["React","useCallback","useMemo","useState","styled","Button","Modal","getFullDisplayBalance","TicketInput","ModalActions","useMultiBuyLottery","useMaxNumber","useI18n","LOTTERY_MAX_NUMBER_OF_TICKETS","LOTTERY_TICKET_PRICE","BuyTicketModal","max","onDismiss","val","setVal","pendingTx","setPendingTx","setRequestedBuy","TranslateString","fullBalance","maxTickets","parseInt","div","handleChange","e","currentTarget","value","onMultiBuy","maxNumber","handleBuy","length","numbers","Array","apply","map","Math","floor","random","txHash","toString","console","error","handleSelectMax","Number","cakeCosts","amount","num","Tips","props","theme","colors","primary","Final","Announce"],"mappings":"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","sourcesContent":["import BigNumber from 'bignumber.js'\nimport React, { useCallback, useMemo, useState } from 'react'\nimport styled from 'styled-components'\nimport { Button, Modal } from '@pancakeswap-libs/uikit'\nimport { getFullDisplayBalance } from 'utils/formatBalance'\nimport TicketInput from 'components/TicketInput'\nimport ModalActions from 'components/ModalActions'\nimport { useMultiBuyLottery, useMaxNumber } from 'hooks/useBuyLottery'\nimport useI18n from 'hooks/useI18n'\nimport { LOTTERY_MAX_NUMBER_OF_TICKETS, LOTTERY_TICKET_PRICE } from 'config'\n\ninterface BuyTicketModalProps {\n  max: BigNumber\n  onConfirm?: (amount: string, numbers: Array<number>) => void\n  onDismiss?: () => void\n  tokenName?: string\n}\n\nconst BuyTicketModal: React.FC<BuyTicketModalProps> = ({ max, onDismiss }) => {\n  const [val, setVal] = useState('1')\n  const [pendingTx, setPendingTx] = useState(false)\n  const [, setRequestedBuy] = useState(false)\n  const TranslateString = useI18n()\n  const fullBalance = useMemo(() => {\n    return getFullDisplayBalance(max)\n  }, [max])\n\n  const maxTickets = useMemo(() => {\n    return parseInt(getFullDisplayBalance(max.div(LOTTERY_TICKET_PRICE)), 10)\n  }, [max])\n\n  const handleChange = (e: React.FormEvent<HTMLInputElement>) => setVal(e.currentTarget.value)\n\n  const { onMultiBuy } = useMultiBuyLottery()\n  const maxNumber = useMaxNumber()\n  const handleBuy = useCallback(async () => {\n    try {\n      setRequestedBuy(true)\n      const length = parseInt(val)\n      // @ts-ignore\n      // eslint-disable-next-line prefer-spread\n      const numbers = Array.apply(null, { length }).map(() => [\n        Math.floor(Math.random() * maxNumber) + 1,\n        Math.floor(Math.random() * maxNumber) + 1,\n        Math.floor(Math.random() * maxNumber) + 1,\n        Math.floor(Math.random() * maxNumber) + 1,\n      ])\n      const txHash = await onMultiBuy(LOTTERY_TICKET_PRICE.toString(), numbers)\n      // user rejected tx or didn't go thru\n      if (txHash) {\n        setRequestedBuy(false)\n      }\n    } catch (e) {\n      console.error(e)\n    }\n  }, [onMultiBuy, setRequestedBuy, maxNumber, val])\n\n  const handleSelectMax = useCallback(() => {\n    if (Number(maxTickets) > LOTTERY_MAX_NUMBER_OF_TICKETS) {\n      setVal(LOTTERY_MAX_NUMBER_OF_TICKETS.toString())\n    } else {\n      setVal(maxTickets.toString())\n    }\n  }, [maxTickets])\n\n  const cakeCosts = (amount: string): number => {\n    return +amount * LOTTERY_TICKET_PRICE\n  }\n  return (\n    <Modal title={TranslateString(450, 'Enter amount of tickets to buy')} onDismiss={onDismiss}>\n      <TicketInput\n        value={val}\n        onSelectMax={handleSelectMax}\n        onChange={handleChange}\n        max={fullBalance}\n        symbol=\"TICKET\"\n        availableSymbol=\"CAKE\"\n      />\n      <div>\n        <Tips>{TranslateString(999, `1 Ticket = ${LOTTERY_TICKET_PRICE} CAKE`, { num: LOTTERY_TICKET_PRICE })}</Tips>\n      </div>\n      <div>\n        <Announce>\n          {TranslateString(\n            478,\n            'Ticket purchases are final. Your CAKE cannot be returned to you after buying tickets.',\n          )}\n        </Announce>\n        <Final>{TranslateString(460, `You will spend: ${cakeCosts(val)} CAKE`)}</Final>\n      </div>\n      <ModalActions>\n        <Button fullWidth variant=\"secondary\" onClick={onDismiss}>\n          {TranslateString(462, 'Cancel')}\n        </Button>\n        <Button\n          id=\"lottery-buy-complete\"\n          fullWidth\n          disabled={\n            pendingTx ||\n            parseInt(val) > Number(maxTickets) ||\n            parseInt(val) > LOTTERY_MAX_NUMBER_OF_TICKETS ||\n            parseInt(val) < 1\n          }\n          onClick={async () => {\n            setPendingTx(true)\n            await handleBuy()\n            setPendingTx(false)\n            onDismiss()\n          }}\n        >\n          {pendingTx ? TranslateString(488, 'Pending Confirmation') : TranslateString(464, 'Confirm')}\n        </Button>\n      </ModalActions>\n    </Modal>\n  )\n}\n\nexport default BuyTicketModal\n\nconst Tips = styled.div`\n  margin-left: 0.4em;\n  font-size: 14px;\n  font-weight: 600;\n  color: ${(props) => props.theme.colors.primary};\n`\n\nconst Final = styled.div`\n  margin-top: 1em;\n  text-align: center;\n  font-size: 20px;\n  font-weight: 600;\n  color: ${(props) => props.theme.colors.primary};\n`\nconst Announce = styled.div`\n  margin-top: 1em;\n  margin-left: 0.4em;\n  color: #ed4b9e;\n`\n"]},"metadata":{},"sourceType":"module"}